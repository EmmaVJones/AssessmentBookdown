# Lacustrine Application How To

```{r lacustrine setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


The [Lakes Assessment App](https://rconnect.deq.virginia.gov/IR2024lakesAssessmentApp/) is located on the R server. **The linked version of the application is in draft development stage with DRAFT DATA until after the data solicitation deadline and final product release. Expect this release in late April 2023.**

The purpose of this tool is to expand upon the Station Table summary provided by the automated assessment methodology. A single parameter summary (or in the case of metals, toxics, etc. a single summary of multiple parameters) does not do justice to the data analyzed by the automated assessment process. The Lakes Assessment App provides an interactive data analysis experience to improve users' understanding of automated assessment analyses and decisions. The intended audience is any DEQ employee from regional assessors, field staff to managers, providing better data understanding through interactive data visualizations, descriptive standardized application and WQA guidance explanations, and statewide applicability. 

A notable benefit of these standardized tools is the increased accessibility of assessment decisions. No longer are assessment tools limited to regional assessment staff, resulting in bottlenecks when assessment questions arise. These self-service tools articulate assessment procedures to guide data and decision discussions across multiple end users as needed for timely decisions. 

This tool is a companion to the Station Table throughout the decision-making process. Upon beginning the assessment review period, regional assessment staff download a copy of the statewide Station Table (available inside either the Riverine or Lakes App). This copy is manipulated locally by regional assessment staff as decisions are reviewed (using these interactive applications) and entered into WQA CEDS. The next sections will detail typical workflow procedures to using this tool for data exploration and/or assessment. 

## Application Orientation

This application brings station-level automated analyses- provided in the Station Table- to life through interactive data visualizations, maps, and tables. The tool is divided into three tabs that must be visited sequentially for proper application functionality. The `Data Upload` tab provides a basic overview of application data sources, provides download of the statewide Station Table resultant from previous automated assessment procedures, and requires upload of either the default Station Table or a custom Station Table (e.g. the Station Table filtered to a specific region). The `Lake Selection` tab allows further investigation of particular lakes by assessment region. This tab offers high level summaries of stations within a chosen lake. The `Assessment Unit Review` tab dives into all assessment units and stations contained within a selected lake. By drilling down from lake to assessment unit to station, users may explore assessment data against applicable Water Quality Standards and criteria to better understand how assessment guidance leads assessment staff to appropriate decisions across designated uses. Previous assessment decisions are provided along with all centrally stored assessment data to provide a full picture of stations that require addressing during a given assessment cycle.

## Application Use: Data Upload Tab


The `Data Upload` tab is the first screen to appear on application load. The purpose of this screen is to orient users to basic application usage and data sources and to provide a location to upload the Station Table. The Station Table is key to running any subsequent parts of this application. Users may download the latest copy of the statewide Station Table using the `Download statewide example dataset to upload to the tool.` button at the bottom of the screen. Helptext below the download button indicates the last time the Station Table template was updated. 

The Station Table must be uploaded to the application each time the tool is used. The reason the tool requires an upload of the Station Table each use is to allow flexibility for regional assessment staff to change station assessment unit (AU) designations throughout the assessment process. If this dataset were sourced from the R server like all other datasets used by the Lakes App, then assessors would need to notify the Assessment Data Analyst each time a station AU changes, is split, or requires additional AUs. By allowing the regional assessment staff to edit this information in a .csv, the application allows self-service changes to station organization.

Users may upload the entire statewide Station Table to the `Browse` button in the tool or a version filtered and saved locally with just the region of interest. 

![](images/lakes1.png)

## Application Use: Lake Selection Tab

The `Lake Selection` tab allows users to choose a particular region to investigate further. Using the drop down menu in the sidebar panel, users must choose one assessment region and then click `Retrieve Assessment Units From Server` in order to proceed with any analyses. Based on the assessment region selected, the application then extracts the appropriate spatial data from standardized datasets saved on the R server and provides that information to the application. A progress message is visible in the lower right of the screen while this data transaction occurs.

Once this data is available to the application, the user may further refine data by using a dynamic filtering drop down on the sidebar panel. Users may select from only the lakes within the selected assessment region. An interactive map dynamically updates to display the user selection on the main panel of the application. Additional information about the each AU and station within the lake may be found in the popup table revealed upon clicking on a each item in the interactive map. Users may zoom in/out, change baselayers or data layers plotted, and hover/click on map items using the interactive leaflet map in the main panel of the application.

![](images/lakes2.png)


The main panel of the `Lake Selection` tab details information about the selected lake. The interactive map describes spatially where the lake falls within the state. Subsequent tables detail the AUs and stations within the VAHU6. The "Assessment Units in Selected Lake" table lists all AUs that fall inside the selected lake, retrieved from the previous Assessment cycle spatial layer. The "Stations in Selected Lake that were sampled in current window" table identifies all stations that fall within the lake with data in the current Assessment cycle. Stations in this table that lack most of the metadata are likely sampled only by programs that do not enter data into CEDS (e.g. PCB or Fish Tissue data). This can be confirmed in the Data_Source field where a "Data from outside conventionals query" flag will be noted. These stations can still be analyzed using the application, but they will lack data in the typical field and analyte analysis modules.

The last table identifies stations in selected lake that have no data in the current window but were carried over from last cycle due to an IM designation in one of the previous IR status fields or the previous IR Station Table reports the station was carried over from a more previous cycle. The purpose of this table is to identify which stations in the selected lake are carried over from a previous cycle and require review before carrying forward another cycle. These stations can be viewed in the application and Station Table, but none of the parameter modules will display data as no data is available in the current window.

**To view a station in the Lakes App, each station must have at least one ID305B field with a valid lake AU and WATER_TYPE must equal to RESERVOIR. Riverine and estuarine stations can reside in the uploaded Station Table, but only stations that comply with the logic set out above will be able to be analyzed in the Lakes App."


## Application Use: Assessment Unit Review Tab
