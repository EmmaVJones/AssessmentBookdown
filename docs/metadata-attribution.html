<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3.1 Metadata Attribution | DEQ Water Quality Automated Assessment User Guide</title>
  <meta name="description" content="A companion document describing the WQA automated assessment methodology." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="3.1 Metadata Attribution | DEQ Water Quality Automated Assessment User Guide" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A companion document describing the WQA automated assessment methodology." />
  <meta name="github-repo" content="openscapes/series" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3.1 Metadata Attribution | DEQ Water Quality Automated Assessment User Guide" />
  
  <meta name="twitter:description" content="A companion document describing the WQA automated assessment methodology." />
  

<meta name="author" content="DEQ Automated Assessment Team" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="automated-assessment-methods.html"/>
<link rel="next" href="organize-metadata.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.13/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.3/leaflet.js"></script>
<script src="assets/book.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="lib/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="lib/css/style.css" type="text/css" />
<link rel="stylesheet" href="lib/css/lesson.css" type="text/css" />
<link rel="stylesheet" href="assets/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">DEQ Water Quality Automated Assessment User Manual</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="HowToUseDocument.html"><a href="HowToUseDocument.html"><i class="fa fa-check"></i><b>1.1</b> How to Use Document</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="HowToUseDocument.html"><a href="HowToUseDocument.html#ProgrammingExpectations"><i class="fa fa-check"></i><b>1.1.1</b> Programming Expectations</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="ProjectHistory.html"><a href="ProjectHistory.html"><i class="fa fa-check"></i><b>1.2</b> Project History</a></li>
<li class="chapter" data-level="1.3" data-path="wqa-technical-support-team.html"><a href="wqa-technical-support-team.html"><i class="fa fa-check"></i><b>1.3</b> WQA Technical Support Team</a></li>
<li class="chapter" data-level="1.4" data-path="Acknowledgements.html"><a href="Acknowledgements.html"><i class="fa fa-check"></i><b>1.4</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-organization.html"><a href="data-organization.html"><i class="fa fa-check"></i><b>2</b> Data Organization</a>
<ul>
<li class="chapter" data-level="2.1" data-path="conventionals-data.html"><a href="conventionals-data.html"><i class="fa fa-check"></i><b>2.1</b> Conventionals Data</a></li>
<li class="chapter" data-level="2.2" data-path="water-column-metals.html"><a href="water-column-metals.html"><i class="fa fa-check"></i><b>2.2</b> Water Column Metals</a></li>
<li class="chapter" data-level="2.3" data-path="sediment-metals.html"><a href="sediment-metals.html"><i class="fa fa-check"></i><b>2.3</b> Sediment Metals</a></li>
<li class="chapter" data-level="2.4" data-path="fish-tissue-data.html"><a href="fish-tissue-data.html"><i class="fa fa-check"></i><b>2.4</b> Fish Tissue Data</a></li>
<li class="chapter" data-level="2.5" data-path="pcb-data.html"><a href="pcb-data.html"><i class="fa fa-check"></i><b>2.5</b> PCB Data</a></li>
<li class="chapter" data-level="2.6" data-path="vdh-data.html"><a href="vdh-data.html"><i class="fa fa-check"></i><b>2.6</b> VDH Data</a></li>
<li class="chapter" data-level="2.7" data-path="citizen-monitoring-data.html"><a href="citizen-monitoring-data.html"><i class="fa fa-check"></i><b>2.7</b> Citizen Monitoring Data</a></li>
<li class="chapter" data-level="2.8" data-path="station-metadata.html"><a href="station-metadata.html"><i class="fa fa-check"></i><b>2.8</b> Station Metadata</a></li>
<li class="chapter" data-level="2.9" data-path="low-flow-7q10-data.html"><a href="low-flow-7q10-data.html"><i class="fa fa-check"></i><b>2.9</b> Low Flow (7Q10) Data</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="low-flow-7q10-data.html"><a href="low-flow-7q10-data.html#q10-method"><i class="fa fa-check"></i><b>2.9.1</b> 7Q10 Method</a></li>
<li class="chapter" data-level="2.9.2" data-path="low-flow-7q10-data.html"><a href="low-flow-7q10-data.html#usgs-site-data-gathering"><i class="fa fa-check"></i><b>2.9.2</b> USGS Site Data Gathering</a></li>
<li class="chapter" data-level="2.9.3" data-path="low-flow-7q10-data.html"><a href="low-flow-7q10-data.html#important-7q10-calculation-notes"><i class="fa fa-check"></i><b>2.9.3</b> Important 7Q10 Calculation Notes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="automated-assessment-methods.html"><a href="automated-assessment-methods.html"><i class="fa fa-check"></i><b>3</b> Automated Assessment Methods</a>
<ul>
<li class="chapter" data-level="3.1" data-path="metadata-attribution.html"><a href="metadata-attribution.html"><i class="fa fa-check"></i><b>3.1</b> Metadata Attribution</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="metadata-attribution.html"><a href="metadata-attribution.html#distinct-sites"><i class="fa fa-check"></i><b>3.1.1</b> Distinct Sites</a></li>
<li class="chapter" data-level="3.1.2" data-path="metadata-attribution.html"><a href="metadata-attribution.html#join-assessment-region-and-subbasin-information"><i class="fa fa-check"></i><b>3.1.2</b> Join Assessment Region and Subbasin Information</a></li>
<li class="chapter" data-level="3.1.3" data-path="metadata-attribution.html"><a href="metadata-attribution.html#join-stations-to-wqs"><i class="fa fa-check"></i><b>3.1.3</b> Join Stations to WQS</a></li>
<li class="chapter" data-level="3.1.4" data-path="metadata-attribution.html"><a href="metadata-attribution.html#join-stations-to-aus"><i class="fa fa-check"></i><b>3.1.4</b> Join Stations to AUs</a></li>
<li class="chapter" data-level="3.1.5" data-path="metadata-attribution.html"><a href="metadata-attribution.html#where-does-this-information-go"><i class="fa fa-check"></i><b>3.1.5</b> Where does this information go?</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="organize-metadata.html"><a href="organize-metadata.html"><i class="fa fa-check"></i><b>3.2</b> Organize Metadata</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="organize-metadata.html"><a href="organize-metadata.html#reorganize-conventionals-dataset"><i class="fa fa-check"></i><b>3.2.1</b> Reorganize Conventionals Dataset</a></li>
<li class="chapter" data-level="3.2.2" data-path="organize-metadata.html"><a href="organize-metadata.html#adding-secchi-depth-to-conventionals-dataset"><i class="fa fa-check"></i><b>3.2.2</b> Adding Secchi Depth to conventionals dataset</a></li>
<li class="chapter" data-level="3.2.3" data-path="organize-metadata.html"><a href="organize-metadata.html#add-citizen-monitoring-data-to-conventionals"><i class="fa fa-check"></i><b>3.2.3</b> Add Citizen Monitoring Data to conventionals</a></li>
<li class="chapter" data-level="3.2.4" data-path="organize-metadata.html"><a href="organize-metadata.html#ensure-all-stations-have-necessary-wqs-and-au-information"><i class="fa fa-check"></i><b>3.2.4</b> Ensure all stations have necessary WQS and AU information</a></li>
<li class="chapter" data-level="3.2.5" data-path="organize-metadata.html"><a href="organize-metadata.html#clean-up-pcb-dataset"><i class="fa fa-check"></i><b>3.2.5</b> Clean up PCB dataset</a></li>
<li class="chapter" data-level="3.2.6" data-path="organize-metadata.html"><a href="organize-metadata.html#clean-up-fish-tissue-dataset"><i class="fa fa-check"></i><b>3.2.6</b> Clean up Fish Tissue dataset</a></li>
<li class="chapter" data-level="3.2.7" data-path="organize-metadata.html"><a href="organize-metadata.html#pin-official-clean-ir-data-to-r-server"><i class="fa fa-check"></i><b>3.2.7</b> Pin Official Clean IR data to R server</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="automated-assessment.html"><a href="automated-assessment.html"><i class="fa fa-check"></i><b>3.3</b> Automated Assessment</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="automated-assessment.html"><a href="automated-assessment.html#bring-in-required-datasets"><i class="fa fa-check"></i><b>3.3.1</b> Bring in required datasets</a></li>
<li class="chapter" data-level="3.3.2" data-path="automated-assessment.html"><a href="automated-assessment.html#attach-wqs-information"><i class="fa fa-check"></i><b>3.3.2</b> Attach WQS information</a></li>
<li class="chapter" data-level="3.3.3" data-path="automated-assessment.html"><a href="automated-assessment.html#identify-station-type"><i class="fa fa-check"></i><b>3.3.3</b> Identify Station Type</a></li>
<li class="chapter" data-level="3.3.4" data-path="automated-assessment.html"><a href="automated-assessment.html#bring-in-low-flow-information"><i class="fa fa-check"></i><b>3.3.4</b> Bring in Low Flow Information</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="automated-assessment-analysis.html"><a href="automated-assessment-analysis.html"><i class="fa fa-check"></i><b>3.4</b> Automated Assessment Analysis</a></li>
<li class="chapter" data-level="3.5" data-path="individual-parameter-analyses.html"><a href="individual-parameter-analyses.html"><i class="fa fa-check"></i><b>3.5</b> Individual Parameter Analyses</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="individual-parameter-analyses.html"><a href="individual-parameter-analyses.html#how-to-test-individual-parameter-functions"><i class="fa fa-check"></i><b>3.5.1</b> How to Test Individual Parameter Functions</a></li>
<li class="chapter" data-level="3.5.2" data-path="individual-parameter-analyses.html"><a href="individual-parameter-analyses.html#temperature"><i class="fa fa-check"></i><b>3.5.2</b> Temperature</a></li>
<li class="chapter" data-level="3.5.3" data-path="individual-parameter-analyses.html"><a href="individual-parameter-analyses.html#dissolved-oxygen"><i class="fa fa-check"></i><b>3.5.3</b> Dissolved Oxygen</a></li>
<li class="chapter" data-level="3.5.4" data-path="individual-parameter-analyses.html"><a href="individual-parameter-analyses.html#ph"><i class="fa fa-check"></i><b>3.5.4</b> pH</a></li>
<li class="chapter" data-level="3.5.5" data-path="individual-parameter-analyses.html"><a href="individual-parameter-analyses.html#bacteria"><i class="fa fa-check"></i><b>3.5.5</b> Bacteria</a></li>
<li class="chapter" data-level="3.5.6" data-path="individual-parameter-analyses.html"><a href="individual-parameter-analyses.html#nutrients"><i class="fa fa-check"></i><b>3.5.6</b> Nutrients</a></li>
<li class="chapter" data-level="3.5.7" data-path="individual-parameter-analyses.html"><a href="individual-parameter-analyses.html#ammonia"><i class="fa fa-check"></i><b>3.5.7</b> Ammonia</a></li>
<li class="chapter" data-level="3.5.8" data-path="individual-parameter-analyses.html"><a href="individual-parameter-analyses.html#water-column-toxics"><i class="fa fa-check"></i><b>3.5.8</b> Water Column Toxics</a></li>
<li class="chapter" data-level="3.5.9" data-path="individual-parameter-analyses.html"><a href="individual-parameter-analyses.html#public-water-supply-criteria"><i class="fa fa-check"></i><b>3.5.9</b> Public Water Supply Criteria</a></li>
<li class="chapter" data-level="3.5.10" data-path="individual-parameter-analyses.html"><a href="individual-parameter-analyses.html#freshwater-chloride"><i class="fa fa-check"></i><b>3.5.10</b> Freshwater Chloride</a></li>
<li class="chapter" data-level="3.5.11" data-path="individual-parameter-analyses.html"><a href="individual-parameter-analyses.html#pcb"><i class="fa fa-check"></i><b>3.5.11</b> PCB</a></li>
<li class="chapter" data-level="3.5.12" data-path="individual-parameter-analyses.html"><a href="individual-parameter-analyses.html#metals"><i class="fa fa-check"></i><b>3.5.12</b> Metals</a></li>
<li class="chapter" data-level="3.5.13" data-path="individual-parameter-analyses.html"><a href="individual-parameter-analyses.html#fish-tissue"><i class="fa fa-check"></i><b>3.5.13</b> Fish Tissue</a></li>
<li class="chapter" data-level="3.5.14" data-path="individual-parameter-analyses.html"><a href="individual-parameter-analyses.html#benthics"><i class="fa fa-check"></i><b>3.5.14</b> Benthics</a></li>
<li class="chapter" data-level="3.5.15" data-path="individual-parameter-analyses.html"><a href="individual-parameter-analyses.html#additional-functions"><i class="fa fa-check"></i><b>3.5.15</b> Additional Functions</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="automated-output.html"><a href="automated-output.html"><i class="fa fa-check"></i><b>3.6</b> Automated Output</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="regional-metadata-validation-tool-how-to.html"><a href="regional-metadata-validation-tool-how-to.html"><i class="fa fa-check"></i><b>4</b> Regional Metadata Validation <br>Tool How To</a>
<ul>
<li class="chapter" data-level="4.1" data-path="application-orientation.html"><a href="application-orientation.html"><i class="fa fa-check"></i><b>4.1</b> Application Orientation</a></li>
<li class="chapter" data-level="4.2" data-path="application-use-water-quality-standards-qa-watershed-selection-tab.html"><a href="application-use-water-quality-standards-qa-watershed-selection-tab.html"><i class="fa fa-check"></i><b>4.2</b> Application Use: <br>Water Quality Standards QA- <br>Watershed Selection Tab</a></li>
<li class="chapter" data-level="4.3" data-path="application-use-water-quality-standards-qa-manual-review-tab.html"><a href="application-use-water-quality-standards-qa-manual-review-tab.html"><i class="fa fa-check"></i><b>4.3</b> Application Use: <br>Water Quality Standards QA- <br>Manual Review Tab</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="application-use-water-quality-standards-qa-manual-review-tab.html"><a href="application-use-water-quality-standards-qa-manual-review-tab.html#map-orientation"><i class="fa fa-check"></i><b>4.3.1</b> Map Orientation</a></li>
<li class="chapter" data-level="4.3.2" data-path="application-use-water-quality-standards-qa-manual-review-tab.html"><a href="application-use-water-quality-standards-qa-manual-review-tab.html#what-do-the-buttons-do"><i class="fa fa-check"></i><b>4.3.2</b> What do the buttons do?</a></li>
<li class="chapter" data-level="4.3.3" data-path="application-use-water-quality-standards-qa-manual-review-tab.html"><a href="application-use-water-quality-standards-qa-manual-review-tab.html#application-operation"><i class="fa fa-check"></i><b>4.3.3</b> Application Operation</a></li>
<li class="chapter" data-level="4.3.4" data-path="application-use-water-quality-standards-qa-manual-review-tab.html"><a href="application-use-water-quality-standards-qa-manual-review-tab.html#application-operation-station-that-snapped-to-1-wqs-segment"><i class="fa fa-check"></i><b>4.3.4</b> Application Operation: <br>Station that Snapped to 1 WQS Segment</a></li>
<li class="chapter" data-level="4.3.5" data-path="application-use-water-quality-standards-qa-manual-review-tab.html"><a href="application-use-water-quality-standards-qa-manual-review-tab.html#application-operation-station-that-snapped-to-1-wqs-segment-1"><i class="fa fa-check"></i><b>4.3.5</b> Application Operation: <br>Station that Snapped to &gt;1 WQS Segment</a></li>
<li class="chapter" data-level="4.3.6" data-path="application-use-water-quality-standards-qa-manual-review-tab.html"><a href="application-use-water-quality-standards-qa-manual-review-tab.html#application-operation-station-that-snapped-to-0-wqs-segments"><i class="fa fa-check"></i><b>4.3.6</b> Application Operation: <br>Station that Snapped to 0 WQS Segments</a></li>
<li class="chapter" data-level="4.3.7" data-path="application-use-water-quality-standards-qa-manual-review-tab.html"><a href="application-use-water-quality-standards-qa-manual-review-tab.html#application-operation-there-are-no-more-stations-to-attribute"><i class="fa fa-check"></i><b>4.3.7</b> Application Operation: <br>There are no more stations to attribute</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="having-problems.html"><a href="having-problems.html"><i class="fa fa-check"></i><b>4.4</b> Having problems?</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="riverine-application-how-to.html"><a href="riverine-application-how-to.html"><i class="fa fa-check"></i><b>5</b> Riverine Application How To</a></li>
<li class="chapter" data-level="6" data-path="lacustrine-application-how-to.html"><a href="lacustrine-application-how-to.html"><i class="fa fa-check"></i><b>6</b> Lacustrine Application How To</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">DEQ Water Quality Automated Assessment User Guide</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="metadata-attribution" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Metadata Attribution</h2>
<p>The automated assessment process hinges on each station having the appropriate metadata to analyze all raw data. The required metadata for each station include what Water Quality Standards apply to the station and which Assessment Unit(s) describe the station. One or more station can be included in an Assessment Unit. It is ultimately the Assessment Units that are used to determine whether or not designated uses are met, which is where the automation stops and the human analysis component is required.</p>
<p>In practice, metadata are spatially joined to stations by a rigorous data organization, spatial joining, and QA process that is detailed below. This automated process runs on the Assessment Data Analystâ€™s computer and results are provided to regional assessment staff for individual review through a shared shiny application. This application is known as the <a href="https://rconnect.deq.virginia.gov/RegionalAssessmentMetadataValidation/">Regional Metadata Validation Tool</a> and is hosted on the R server. It is up to each regional assessor to manually review each suggested metadata link prior to the assessment start date. After stations have completed the manual review process, they can be analyzed using the automated assessment scripts. Detailed instructions on how to use the <a href="https://rconnect.deq.virginia.gov/RegionalAssessmentMetadataValidation/" target="_blank">Regional Metadata Validation Tool</a> is available in the <a href="regional-metadata-validation-tool-how-to.html#regional-metadata-validation-tool-how-to">Regional Metadata Validation Tool How To</a> section.</p>
<div id="distinct-sites" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Distinct Sites</h3>
<p>Before station metadata can be linked to stations, a list of unique stations that were sampled in a given assessment window is required. Because multiple data sources are combined for an assessment, each unique station from each data source with data in the given IR window are included in this list.</p>
<p>For the purposes of the Automated Assessment User Guide, we will overview the process with a snippet of conventionals and citizen monitoring data types. Please see the <a href="https://github.com/EmmaVJones/IR2024/blob/main/1.preprocessData/HowToPreprocessData.Rmd" target="_blank">official script</a> for more information.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="metadata-attribution.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb15-2"><a href="metadata-attribution.html#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb15-3"><a href="metadata-attribution.html#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pins)</span>
<span id="cb15-4"><a href="metadata-attribution.html#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(config)</span>
<span id="cb15-5"><a href="metadata-attribution.html#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb15-6"><a href="metadata-attribution.html#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="metadata-attribution.html#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Connect to server</span></span>
<span id="cb15-8"><a href="metadata-attribution.html#cb15-8" aria-hidden="true" tabindex="-1"></a>conn <span class="ot">&lt;-</span> config<span class="sc">::</span><span class="fu">get</span>(<span class="st">&quot;connectionSettings&quot;</span>) <span class="co"># get configuration settings</span></span>
<span id="cb15-9"><a href="metadata-attribution.html#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="metadata-attribution.html#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="fu">board_register_rsconnect</span>(<span class="at">key =</span> conn<span class="sc">$</span>CONNECT_API_KEY,  <span class="co">#Sys.getenv(&quot;CONNECT_API_KEY&quot;),</span></span>
<span id="cb15-11"><a href="metadata-attribution.html#cb15-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">server =</span> conn<span class="sc">$</span>CONNECT_SERVER)<span class="co">#Sys.getenv(&quot;CONNECT_SERVER&quot;))</span></span></code></pre></div>
<p>After setting up your local evironment with necessar packages and connecting to the R server, bring conventionals data into your environment.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="metadata-attribution.html#cb16-1" aria-hidden="true" tabindex="-1"></a>conventionals <span class="ot">&lt;-</span> <span class="fu">pin_get</span>(<span class="st">&#39;ejones/conventionals2024draft&#39;</span>, <span class="at">board =</span> <span class="st">&#39;rsconnect&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb16-2"><a href="metadata-attribution.html#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(FDT_STA_ID, <span class="at">.keep_all =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb16-3"><a href="metadata-attribution.html#cb16-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(FDT_STA_ID, Latitude, Longitude) <span class="sc">%&gt;%</span> </span>
<span id="cb16-4"><a href="metadata-attribution.html#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Data_Source =</span> <span class="st">&#39;DEQ&#39;</span>)</span>
<span id="cb16-5"><a href="metadata-attribution.html#cb16-5" aria-hidden="true" tabindex="-1"></a>conventionals[<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>,] <span class="sc">%&gt;%</span> <span class="co"># preview first 50 rows</span></span>
<span id="cb16-6"><a href="metadata-attribution.html#cb16-6" aria-hidden="true" tabindex="-1"></a>  DT<span class="sc">::</span><span class="fu">datatable</span>(<span class="at">rownames =</span> F, <span class="at">options =</span> <span class="fu">list</span>(<span class="at">dom =</span> <span class="st">&#39;lftip&#39;</span>, <span class="at">pageLength =</span> <span class="dv">5</span>, <span class="at">scrollX =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<div id="htmlwidget-a5a2f4897aebea3a436b" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-a5a2f4897aebea3a436b">{"x":{"filter":"none","data":[["1AABR000.78","1AACC006.13","1AACO006.10","1AACO014.57","1AACO021.28","1AAUA003.00","1AAUA003.71","1AAUA005.35","1AAUA012.15","1AAUA012.55","1AAUA014.51","1ABAR032.10","1ABAR032.50","1ABAR052.96","1ABEC004.76","1ABED000.19","1ABIR000.76","1ABOL000.05","1ABRB002.15","1ABRI000.43","1ABRU001.59","1ABRU020.12","1ABRU029.80","1ABRU037.52","1ABUL010.28","1ABUL025.94","1ACAA001.18","1ACAA007.34","1ACAM002.92","1ACAS000.50","1ACAX004.57","1ACAX008.61","1ACER006.00","1ACER016.46","1ACHC001.50","1ACHO003.65","1ACOA001.44","1ACOA002.87","1ACOA004.24","1ACOW000.38","1ACRA000.42","1ACRA007.81","1ACRB001.52","1ACRB001.66","1ACRF001.18","1ACUB002.61","1ACUB003.74","1ACUB008.60","1ACUB011.25","1ACUB011.78"],[39.179078,38.384251,38.72861111,38.811303,38.861454,38.416342,38.423247,38.43811111,38.48777778,38.48830556,38.490803,39.35663889,39.353142,39.208417,39.03738611,38.49244444,38.83638889,38.913596,39.04666667,37.87975,38.69195833,38.78055556,38.84883333,38.803275,38.80305556,38.88944444,38.83033333,38.87025,38.80447222,38.170742,39.255,39.2325,38.64138889,38.636404,38.15847222,38.52022222,37.981979,37.96685,37.95466667,38.21027778,38.91854167,38.959139,38.155386,38.1537,39.09194444,38.82113333,38.83305555,38.882375,38.90833333,38.91408333],[-78.085543,-77.383453,-77.20333333,-77.230206,-77.270246,-77.345605,-77.354609,-77.36619445,-77.40055556,-77.40713889,-77.433612,-78.18769444,-78.192165,-78.401,-77.72278056,-77.40375,-77.45,-77.890741,-77.43277778,-76.27494444,-77.49440278,-77.67305556,-77.75883333,-77.830572,-77.44972222,-77.57055556,-77.59780555,-77.684,-77.10636111,-76.910611,-77.57666667,-77.59166667,-77.51222222,-77.625626,-76.78277778,-77.36161111,-76.470422,-76.46695,-76.45436111,-77.07611111,-77.92676111,-77.9816,-76.74935,-76.755383,-77.6825,-77.46593056,-77.46361111,-77.46994722,-77.46683333,-77.46763889],["DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>FDT_STA_ID<\/th>\n      <th>Latitude<\/th>\n      <th>Longitude<\/th>\n      <th>Data_Source<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"lftip","pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[1,2]}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<p>Next, bring citizen data into your environment.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="metadata-attribution.html#cb17-1" aria-hidden="true" tabindex="-1"></a>citmon <span class="ot">&lt;-</span>  <span class="fu">readRDS</span>(<span class="st">&#39;exampleData/citmon.RDS&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb17-2"><a href="metadata-attribution.html#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(FDT_STA_ID, <span class="at">.keep_all =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb17-3"><a href="metadata-attribution.html#cb17-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(FDT_STA_ID, Latitude, Longitude, Data_Source)</span>
<span id="cb17-4"><a href="metadata-attribution.html#cb17-4" aria-hidden="true" tabindex="-1"></a>citmon[<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>,] <span class="sc">%&gt;%</span> <span class="co"># preview first 50 rows</span></span>
<span id="cb17-5"><a href="metadata-attribution.html#cb17-5" aria-hidden="true" tabindex="-1"></a>  DT<span class="sc">::</span><span class="fu">datatable</span>(<span class="at">rownames =</span> F, <span class="at">options =</span> <span class="fu">list</span>(<span class="at">dom =</span> <span class="st">&#39;lftip&#39;</span>, <span class="at">pageLength =</span> <span class="dv">5</span>, <span class="at">scrollX =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<div id="htmlwidget-e50aa646058838cb2297" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-e50aa646058838cb2297">{"x":{"filter":"none","data":[["2JMS-35-ALL","NULL","2-APP-ARF-ACB","1AAUS-B3-ALL","2-BRT004.01","2-CKD-CB1-ACB","2-CGB-CGB MR-SOS","2-CHK071.66","3-CAT-CP1-CBGS","3-CAT-CP2-CBGS","3-CAT-CP4-CBGS","3-CAT-CP8-CBGS","2DCHK-CR21-ACB","2-XAR-CR5-ACB","2-DRC-DC1-JRMN","7-DRN-DR3-CBGS","7-XFG-DR6-CBGS","7-DRN-DR9-CBGS","3ENG-1-ALL","3HAL-1-ALL","3MIN-17-ALL","3RPP-18-ALL","7-WIN000.88","2-HYS001.41","2-HYS007.46","2CJOP-JB1-ACB","2BJMS-JRB-JRMN","2BJMS-JRTP-JRMN","3-LIK000.15","2-MOU-MOU-01-SOS","8-PMK-PAMRIV82-ACB","3-XMR002.02","2CXXQ-PRC01-ACB","2-RDD-RC1-ACB","2-RDD-RC3-ACB","2-RDD-RC4-ACB","3-RUS007.41","8-SAR021.22","8SAR-SA2-JRMN","2-SNF000.04","2-SNF-STORUN6.2-RMN","8TLR-TAY2-ALL","3-TOT-TOT 1-ACB","3-TOT-TOT 3-ACB","3-TOT-TOT 4-ACB","2CUPM-UB1-ALL","2CUPM-UB2-ACB","2BXBH-UT1-ACB","7-WAR005.77","2BEN-SBC000.35-SUF"],[37.5246,38.464202,37.30734,38.44946,37.949092,37.51261,37.8828,37.6802779,38.08138889,38.03916667,37.98388889,37.97444444,37.419912,37.6057,37.6179,37.63527778,37.69638889,37.58555556,38.3318,38.2898,38.313611,38.321111,37.3768697,37.911234,37.93414,37.597255,37.6244,37.6652,37.9262344,37.874,37.788696,38.8045,37.59697,37.51467,37.5147872,37.50686,38.72687,37.7598,37.821667,37.6848629,37.75357,37.7645,37.9129344,37.9236345,37.8860358,37.6146,37.59832,37.51483,37.40308,36.87598],[-77.4686,-77.3873577,-78.389257,-77.38381,-79.558395,-77.48008,-79.3859,-77.4550473,-76.84611111,-76.8275,-76.80944444,-76.85388889,-76.97541,-77.5455,-77.989833,-76.69638889,-76.72722222,-76.60305556,-77.5071,-77.4816,-77.540556,-77.488889,-76.2630234,-79.40021,-79.34192,-77.473902,-77.9831,-77.886667,-76.7199799,-79.379,-77.370077,-78.1439,-77.46902,-77.47456,-77.4839271,-77.5043,-78.16991,-77.61262,-77.845278,-77.4492107,-77.48936,-77.64133,-76.6573787,-76.7206799,-76.7362806,-77.4567,-77.46803,-77.48533,-76.48952,-76.48317],["CMC - Riverine Master Naturalists","CMC - Green Aquia","CMC - Alliance for the Chesapeake Bay","CMC - Green Aquia","CMC - Rockbridge Water Monitors","CMC - Reedy Creek Coalition","CMC - Rockbridge Water Monitors","CMC - Alliance for the Chesapeake Bay","CMC - Chesapeake Bay Governor's School","CMC - Chesapeake Bay Governor's School","CMC - Chesapeake Bay Governor's School","CMC - Alliance for the Chesapeake Bay","CMC - Riverine Master Naturalists","CMC - Riverine Master Naturalists","CMC - James River Master Naturalists","CMC - Chesapeake Bay Governor's School","CMC - Chesapeake Bay Governor's School","CMC - Chesapeake Bay Governor's School","CMC - Friends of the Rappahannock","CMC - Friends of the Rappahannock","CMC - Friends of the Rappahannock","CMC - Friends of the Rappahannock","CMC - Middle Peninsula Master Naturalists","CMC - Rockbridge Water Monitors","CMC - Rockbridge Water Monitors","CMC - Riverine Master Naturalists","CMC - James River Master Naturalists","CMC - James River Master Naturalists","CMC - Alliance for the Chesapeake Bay","CMC - Rockbridge Water Monitors","CMC - Riverine Master Naturalists","CMC - Friends of the Rappahannock","CMC - Riverine Master Naturalists","CMC - Reedy Creek Coalition","CMC - Reedy Creek Coalition","CMC - Reedy Creek Coalition","CMC - Alliance for the Chesapeake Bay","CMC - Riverine Master Naturalists","CMC - James River Master Naturalists","CMC - Alliance for the Chesapeake Bay","CMC - Riverine Master Naturalists","CMC - Riverine Master Naturalists","CMC - Alliance for the Chesapeake Bay","CMC - Alliance for the Chesapeake Bay","CMC - Alliance for the Chesapeake Bay","CMC - Riverine Master Naturalists","CMC - Riverine Master Naturalists","CMC - Reedy Creek Coalition","CMC - Middle Peninsula Master Naturalists","CMC - City of Suffolk"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>FDT_STA_ID<\/th>\n      <th>Latitude<\/th>\n      <th>Longitude<\/th>\n      <th>Data_Source<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"lftip","pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[1,2]}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<p>Create an object of unique sites from these two datasets.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="metadata-attribution.html#cb18-1" aria-hidden="true" tabindex="-1"></a>distinctSites <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(conventionals, citmon)</span>
<span id="cb18-2"><a href="metadata-attribution.html#cb18-2" aria-hidden="true" tabindex="-1"></a>distinctSites[<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>,] <span class="sc">%&gt;%</span> <span class="co"># preview first 50 rows</span></span>
<span id="cb18-3"><a href="metadata-attribution.html#cb18-3" aria-hidden="true" tabindex="-1"></a>  DT<span class="sc">::</span><span class="fu">datatable</span>(<span class="at">rownames =</span> F, <span class="at">options =</span> <span class="fu">list</span>(<span class="at">dom =</span> <span class="st">&#39;lftip&#39;</span>, <span class="at">pageLength =</span> <span class="dv">5</span>, <span class="at">scrollX =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<div id="htmlwidget-b59693864bb0b33f8004" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-b59693864bb0b33f8004">{"x":{"filter":"none","data":[["1AABR000.78","1AACC006.13","1AACO006.10","1AACO014.57","1AACO021.28","1AAUA003.00","1AAUA003.71","1AAUA005.35","1AAUA012.15","1AAUA012.55","1AAUA014.51","1ABAR032.10","1ABAR032.50","1ABAR052.96","1ABEC004.76","1ABED000.19","1ABIR000.76","1ABOL000.05","1ABRB002.15","1ABRI000.43","1ABRU001.59","1ABRU020.12","1ABRU029.80","1ABRU037.52","1ABUL010.28","1ABUL025.94","1ACAA001.18","1ACAA007.34","1ACAM002.92","1ACAS000.50","1ACAX004.57","1ACAX008.61","1ACER006.00","1ACER016.46","1ACHC001.50","1ACHO003.65","1ACOA001.44","1ACOA002.87","1ACOA004.24","1ACOW000.38","1ACRA000.42","1ACRA007.81","1ACRB001.52","1ACRB001.66","1ACRF001.18","1ACUB002.61","1ACUB003.74","1ACUB008.60","1ACUB011.25","1ACUB011.78"],[39.179078,38.384251,38.72861111,38.811303,38.861454,38.416342,38.423247,38.43811111,38.48777778,38.48830556,38.490803,39.35663889,39.353142,39.208417,39.03738611,38.49244444,38.83638889,38.913596,39.04666667,37.87975,38.69195833,38.78055556,38.84883333,38.803275,38.80305556,38.88944444,38.83033333,38.87025,38.80447222,38.170742,39.255,39.2325,38.64138889,38.636404,38.15847222,38.52022222,37.981979,37.96685,37.95466667,38.21027778,38.91854167,38.959139,38.155386,38.1537,39.09194444,38.82113333,38.83305555,38.882375,38.90833333,38.91408333],[-78.085543,-77.383453,-77.20333333,-77.230206,-77.270246,-77.345605,-77.354609,-77.36619445,-77.40055556,-77.40713889,-77.433612,-78.18769444,-78.192165,-78.401,-77.72278056,-77.40375,-77.45,-77.890741,-77.43277778,-76.27494444,-77.49440278,-77.67305556,-77.75883333,-77.830572,-77.44972222,-77.57055556,-77.59780555,-77.684,-77.10636111,-76.910611,-77.57666667,-77.59166667,-77.51222222,-77.625626,-76.78277778,-77.36161111,-76.470422,-76.46695,-76.45436111,-77.07611111,-77.92676111,-77.9816,-76.74935,-76.755383,-77.6825,-77.46593056,-77.46361111,-77.46994722,-77.46683333,-77.46763889],["DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>FDT_STA_ID<\/th>\n      <th>Latitude<\/th>\n      <th>Longitude<\/th>\n      <th>Data_Source<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"lftip","pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[1,2]}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<p>This process is repeated for all datasets that have data included in the assessment window. These multiple datasets are combined into a single object named distinctSites that we will then compare to existing WQS and AU information. Where stations in our distinctSites object lack either of these pieces of metadata, we must attribute them.</p>
</div>
<div id="join-assessment-region-and-subbasin-information" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Join Assessment Region and Subbasin Information</h3>
<p>For rendering purposes in the metadata review application, it is important to have each station linked to the appropriate Assessment Region and Subbasin to limit the amount of data called into the application just to essential information. This information is also important for processing each region through a loop for AU connection and WQS attachment. Subbasin information is important for WQS processing. The next chunk reads in the necessary assessment region and subbasin spatial data and spatially joins all sites to these layers. If the sites are missing from the distinctSites_sf object, that means the point plots outside either the assessment region or subbasin polygon. These missingSites are dealt with individually and forced to join to the nearest assessment region and subbasin before rejoining the distinctSites_sf object.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="metadata-attribution.html#cb19-1" aria-hidden="true" tabindex="-1"></a>assessmentLayer <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&#39;GIS/AssessmentRegions_VA84_basins.shp&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="metadata-attribution.html#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>( <span class="fu">st_crs</span>(<span class="dv">4326</span>)) <span class="co"># transform to WQS84 for spatial intersection</span></span>
<span id="cb19-3"><a href="metadata-attribution.html#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="metadata-attribution.html#cb19-4" aria-hidden="true" tabindex="-1"></a>subbasinLayer <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&#39;GIS/DEQ_VAHUSB_subbasins_EVJ.shp&#39;</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb19-5"><a href="metadata-attribution.html#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">&#39;SUBBASIN&#39;</span> <span class="ot">=</span> <span class="st">&#39;SUBBASIN_1&#39;</span>)</span>
<span id="cb19-6"><a href="metadata-attribution.html#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="metadata-attribution.html#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="metadata-attribution.html#cb19-8" aria-hidden="true" tabindex="-1"></a>distinctSites_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(distinctSites,</span>
<span id="cb19-9"><a href="metadata-attribution.html#cb19-9" aria-hidden="true" tabindex="-1"></a>                            <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;Longitude&quot;</span>, <span class="st">&quot;Latitude&quot;</span>),  <span class="co"># make spatial layer using these columns</span></span>
<span id="cb19-10"><a href="metadata-attribution.html#cb19-10" aria-hidden="true" tabindex="-1"></a>                            <span class="at">remove =</span> F, <span class="co"># don&#39;t remove these lat/lon cols from df</span></span>
<span id="cb19-11"><a href="metadata-attribution.html#cb19-11" aria-hidden="true" tabindex="-1"></a>                            <span class="at">crs =</span> <span class="dv">4326</span>) <span class="sc">%&gt;%</span> <span class="co"># add coordinate reference system, needs to be geographic for now bc entering lat/lng, </span></span>
<span id="cb19-12"><a href="metadata-attribution.html#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_intersection</span>(assessmentLayer ) <span class="sc">%&gt;%</span></span>
<span id="cb19-13"><a href="metadata-attribution.html#cb19-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_join</span>(dplyr<span class="sc">::</span><span class="fu">select</span>(subbasinLayer, BASIN_NAME, BASIN_CODE, SUBBASIN), <span class="at">join =</span> st_intersects) </span>
<span id="cb19-14"><a href="metadata-attribution.html#cb19-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-15"><a href="metadata-attribution.html#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="co"># if any joining issues occur, that means that there are stations that fall outside the joined polygon area</span></span>
<span id="cb19-16"><a href="metadata-attribution.html#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="co"># we need to go back in and fix them manually</span></span>
<span id="cb19-17"><a href="metadata-attribution.html#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">nrow</span>(distinctSites_sf) <span class="sc">&lt;</span> <span class="fu">nrow</span>(distinctSites)){</span>
<span id="cb19-18"><a href="metadata-attribution.html#cb19-18" aria-hidden="true" tabindex="-1"></a>  missingSites <span class="ot">&lt;-</span> <span class="fu">filter</span>(distinctSites, <span class="sc">!</span> FDT_STA_ID <span class="sc">%in%</span> distinctSites_sf<span class="sc">$</span>FDT_STA_ID) <span class="sc">%&gt;%</span></span>
<span id="cb19-19"><a href="metadata-attribution.html#cb19-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">st_as_sf</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;Longitude&quot;</span>, <span class="st">&quot;Latitude&quot;</span>),  <span class="co"># make spatial layer using these columns</span></span>
<span id="cb19-20"><a href="metadata-attribution.html#cb19-20" aria-hidden="true" tabindex="-1"></a>             <span class="at">remove =</span> F, <span class="co"># don&#39;t remove these lat/lon cols from df</span></span>
<span id="cb19-21"><a href="metadata-attribution.html#cb19-21" aria-hidden="true" tabindex="-1"></a>             <span class="at">crs =</span> <span class="dv">4326</span>) </span>
<span id="cb19-22"><a href="metadata-attribution.html#cb19-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-23"><a href="metadata-attribution.html#cb19-23" aria-hidden="true" tabindex="-1"></a>  closest <span class="ot">&lt;-</span> <span class="fu">mutate</span>(assessmentLayer[<span class="dv">0</span>,], <span class="at">FDT_STA_ID =</span><span class="cn">NA</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-24"><a href="metadata-attribution.html#cb19-24" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(FDT_STA_ID, <span class="fu">everything</span>())</span>
<span id="cb19-25"><a href="metadata-attribution.html#cb19-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(missingSites))){</span>
<span id="cb19-26"><a href="metadata-attribution.html#cb19-26" aria-hidden="true" tabindex="-1"></a>    closest[i,] <span class="ot">&lt;-</span> assessmentLayer[<span class="fu">which.min</span>(<span class="fu">st_distance</span>(assessmentLayer, missingSites[i,])),] <span class="sc">%&gt;%</span></span>
<span id="cb19-27"><a href="metadata-attribution.html#cb19-27" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">FDT_STA_ID =</span> missingSites[i,]<span class="sc">$</span>FDT_STA_ID) <span class="sc">%&gt;%</span></span>
<span id="cb19-28"><a href="metadata-attribution.html#cb19-28" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">select</span>(FDT_STA_ID, <span class="fu">everything</span>())</span>
<span id="cb19-29"><a href="metadata-attribution.html#cb19-29" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb19-30"><a href="metadata-attribution.html#cb19-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-31"><a href="metadata-attribution.html#cb19-31" aria-hidden="true" tabindex="-1"></a>  missingSites <span class="ot">&lt;-</span> <span class="fu">left_join</span>(missingSites, closest <span class="sc">%&gt;%</span> <span class="fu">st_drop_geometry</span>(),</span>
<span id="cb19-32"><a href="metadata-attribution.html#cb19-32" aria-hidden="true" tabindex="-1"></a>                            <span class="at">by =</span> <span class="st">&#39;FDT_STA_ID&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-33"><a href="metadata-attribution.html#cb19-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">st_join</span>(dplyr<span class="sc">::</span><span class="fu">select</span>(subbasinLayer, BASIN_NAME, BASIN_CODE, SUBBASIN), <span class="at">join =</span> st_intersects) <span class="sc">%&gt;%</span></span>
<span id="cb19-34"><a href="metadata-attribution.html#cb19-34" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(geometry), geometry) <span class="sc">%&gt;%</span></span>
<span id="cb19-35"><a href="metadata-attribution.html#cb19-35" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">names</span>(distinctSites_sf))</span>
<span id="cb19-36"><a href="metadata-attribution.html#cb19-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-37"><a href="metadata-attribution.html#cb19-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-38"><a href="metadata-attribution.html#cb19-38" aria-hidden="true" tabindex="-1"></a>  distinctSites_sf <span class="ot">&lt;-</span> <span class="fu">rbind</span>(distinctSites_sf, missingSites)</span>
<span id="cb19-39"><a href="metadata-attribution.html#cb19-39" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="join-stations-to-wqs" class="section level3" number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Join Stations to WQS</h3>
<p>All stations are then spatially joined to the current WQS spatial layers to link each unique StationID to a unique WQS_ID. These unique WQS_IDâ€™s are a concatination of the waterbody type, basin code (e.g.Â 2A, 2B, 2C, etc.), and a number associated with each segment in the spatial layer.</p>
<p>Waterbody types include:</p>
<ul>
<li>RL = Riverine Line</li>
<li>LP = Lacustrine Polygon</li>
<li>EL = Estuarine Line</li>
<li>EP = Estuarine Polygon</li>
</ul>
<p>Since transitioning the WQS storage from local (individual assessor files) to a centralized system (on the R server for multiple program uses), the number of stations that require WQS attribution decreases significantly each IR cycle. To attribute each station to WQS information, we first need to do all spatial joins to new WQS layer to get appropriate UID information, then we can send that information to an interactive application for humans to manually verify.</p>
<p>Where WQS_ID information is already available for stations, they are first removed from the WQS snapping process as to not repeat efforts unnecessarily. WQS_IDâ€™s are maintained across WQS layer updates, so any new WQS information will be updated when the stations are joined to the WQS metadata.</p>
<p>You can view the available WQSlookup table stored on the server by using the below script. Please see the <a href="https://rconnect.deq.virginia.gov/MethodsEncyclopedia/connectToConnectPins.html">DEQ R Methods Encyclopedia</a> for information on how to retrieve pinned data from the server.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="metadata-attribution.html#cb20-1" aria-hidden="true" tabindex="-1"></a>WQStableExisting <span class="ot">&lt;-</span> <span class="fu">pin_get</span>(<span class="st">&#39;ejones/WQSlookup&#39;</span>, <span class="at">board =</span> <span class="st">&#39;rsconnect&#39;</span>)</span>
<span id="cb20-2"><a href="metadata-attribution.html#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="metadata-attribution.html#cb20-3" aria-hidden="true" tabindex="-1"></a>distinctSitesToDoWQS <span class="ot">&lt;-</span> <span class="fu">filter</span>(distinctSites_sf, <span class="sc">!</span> FDT_STA_ID  <span class="sc">%in%</span> WQStableExisting<span class="sc">$</span>StationID)</span></code></pre></div>
<p>Here is the table used to store link information from stations to appropriate WQS.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="metadata-attribution.html#cb21-1" aria-hidden="true" tabindex="-1"></a>WQStable <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">StationID =</span> <span class="cn">NA</span>, <span class="at">WQS_ID =</span> <span class="cn">NA</span>)</span></code></pre></div>
<div id="spatially-join-wqs-polygons" class="section level4" number="3.1.3.1">
<h4><span class="header-section-number">3.1.3.1</span> Spatially Join WQS Polygons</h4>
<p>Since it is much faster to look for spatial joins by polygons compared to snapping to lines, we will run spatial joins by estuarine polys and reservoir layers first.</p>
<div id="estuarine-polygons-wqs" class="section level6" number="3.1.3.1.0.1">
<h6><span class="header-section-number">3.1.3.1.0.1</span> Estuarine Polygons (WQS)</h6>
<p>Here we find any sites that fall into an estuary WQS polygon. This method is only applied to subbasins that intersect estuarine areas. This process also removes any estuarine sites from the data frame of unique sites that need WQS information (distinctSitesToDoWQS).</p>
<p>We will bring in (source) a custom function that runs the analysis for us, feed it our latest WQS information, and let the function run across all input stations. You can see the latest version of the sourced script in <a href="https://github.com/EmmaVJones/IR2024/tree/main/1.preprocessData">this repository.</a></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="metadata-attribution.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&#39;preprocessingModules/WQS_estuaryPoly.R&#39;</span>)</span>
<span id="cb22-2"><a href="metadata-attribution.html#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="metadata-attribution.html#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Bring in estuary layer</span></span>
<span id="cb22-4"><a href="metadata-attribution.html#cb22-4" aria-hidden="true" tabindex="-1"></a>estuarinePolys <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&#39;../GIS/draft_WQS_shapefiles_2022/estuarinepolygons_draft2022.shp&#39;</span>, </span>
<span id="cb22-5"><a href="metadata-attribution.html#cb22-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fid_column_name =</span> <span class="st">&quot;OBJECTID&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-6"><a href="metadata-attribution.html#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="dv">4326</span>)</span>
<span id="cb22-7"><a href="metadata-attribution.html#cb22-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-8"><a href="metadata-attribution.html#cb22-8" aria-hidden="true" tabindex="-1"></a>WQStable <span class="ot">&lt;-</span> <span class="fu">estuaryPolygonJoin</span>(estuarinePolys, distinctSitesToDoWQS, WQStable)</span>
<span id="cb22-9"><a href="metadata-attribution.html#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="metadata-attribution.html#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(estuarinePolys) <span class="co"># clean up workspace</span></span></code></pre></div>
<p>Remove stations that fell inside estuarine polygons from the â€˜to doâ€™ list.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="metadata-attribution.html#cb23-1" aria-hidden="true" tabindex="-1"></a>distinctSitesToDoWQS <span class="ot">&lt;-</span> <span class="fu">filter</span>(distinctSitesToDoWQS, <span class="sc">!</span> FDT_STA_ID <span class="sc">%in%</span> WQStable<span class="sc">$</span>StationID)</span></code></pre></div>
</div>
<div id="lake-polygons-wqs" class="section level5" number="3.1.3.1.1">
<h5><span class="header-section-number">3.1.3.1.1</span> Lake Polygons (WQS)</h5>
<p>Next find any sites that fall into a lake WQS polygon. This method is applied to all subbasins at once as it is a simple spatial join. You can see the latest version of the sourced script in <a href="https://github.com/EmmaVJones/IR2024/tree/main/1.preprocessData">this repository.</a></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="metadata-attribution.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&#39;preprocessingModules/WQS_lakePoly.R&#39;</span>)</span>
<span id="cb24-2"><a href="metadata-attribution.html#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="metadata-attribution.html#cb24-3" aria-hidden="true" tabindex="-1"></a>lakesPoly <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&#39;../GIS/draft_WQS_shapefiles_2022/lakes_reservoirs_draft2022.shp&#39;</span>,</span>
<span id="cb24-4"><a href="metadata-attribution.html#cb24-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">fid_column_name =</span> <span class="st">&quot;OBJECTID&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-5"><a href="metadata-attribution.html#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="dv">4326</span>)</span>
<span id="cb24-6"><a href="metadata-attribution.html#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="metadata-attribution.html#cb24-7" aria-hidden="true" tabindex="-1"></a>WQStable <span class="ot">&lt;-</span> <span class="fu">lakePolygonJoin</span>(lakesPoly, distinctSitesToDoWQS, WQStable)</span>
<span id="cb24-8"><a href="metadata-attribution.html#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="metadata-attribution.html#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(lakesPoly) <span class="co"># clean up workspace</span></span></code></pre></div>
<p>Remove stations that fell inside lake polygons from the â€˜to doâ€™ list.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="metadata-attribution.html#cb25-1" aria-hidden="true" tabindex="-1"></a>distinctSitesToDoWQS <span class="ot">&lt;-</span> <span class="fu">filter</span>(distinctSitesToDoWQS, <span class="sc">!</span> FDT_STA_ID <span class="sc">%in%</span> WQStable<span class="sc">$</span>StationID)</span></code></pre></div>
</div>
</div>
<div id="spatially-join-wqs-lines" class="section level4" number="3.1.3.2">
<h4><span class="header-section-number">3.1.3.2</span> Spatially Join WQS Lines</h4>
<p>Now on to the more computationally heavy WQS line snapping methods. First we will try to attach riverine WQS and where stations remain we will try the estuarine WQS snap.</p>
<div id="riverine-lines-wqs" class="section level5" number="3.1.3.2.1">
<h5><span class="header-section-number">3.1.3.2.1</span> Riverine Lines (WQS)</h5>
<p>To do this join, we will buffer all sites that donâ€™t fall into a polygon layer by a set sequence of distances. The output will add a field called <code>Buffer Distance</code> to the WQStable to indicate distance required for snapping. If more than one segment is found within a set buffer distance, then many rows will be attached to the WQStable with the single identifying station name. It is up to the QA tool to help the user determine which of these UIDâ€™s are correct and drop the other records.</p>
<p>We then remove any riverine sites from the data frame of unique sites that need WQS information (distinctSitesToDoWQS).</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="metadata-attribution.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&#39;snappingFunctions/snapWQS.R&#39;</span>)</span>
<span id="cb26-2"><a href="metadata-attribution.html#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="metadata-attribution.html#cb26-3" aria-hidden="true" tabindex="-1"></a>riverine <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&#39;../GIS/draft_WQS_shapefiles_2022/riverine_draft2022.shp&#39;</span>,</span>
<span id="cb26-4"><a href="metadata-attribution.html#cb26-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">fid_column_name =</span> <span class="st">&quot;OBJECTID&quot;</span>) </span>
<span id="cb26-5"><a href="metadata-attribution.html#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="metadata-attribution.html#cb26-6" aria-hidden="true" tabindex="-1"></a>WQStable <span class="ot">&lt;-</span> <span class="fu">snapAndOrganizeWQS</span>(distinctSitesToDoWQS, <span class="st">&#39;FDT_STA_ID&#39;</span>, riverine, </span>
<span id="cb26-7"><a href="metadata-attribution.html#cb26-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">bufferDistances =</span> <span class="fu">seq</span>(<span class="dv">20</span>,<span class="dv">80</span>,<span class="at">by=</span><span class="dv">20</span>),  <span class="co"># buffering by 20m from 20 - 80 meters</span></span>
<span id="cb26-8"><a href="metadata-attribution.html#cb26-8" aria-hidden="true" tabindex="-1"></a>                               WQStable)</span>
<span id="cb26-9"><a href="metadata-attribution.html#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(riverine) <span class="co"># clean up workspace</span></span></code></pre></div>
<p>Remove stations that attached to riverine segments from the â€˜to doâ€™ list.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="metadata-attribution.html#cb27-1" aria-hidden="true" tabindex="-1"></a>distinctSitesToDoWQS <span class="ot">&lt;-</span> <span class="fu">filter</span>(distinctSitesToDoWQS, <span class="sc">!</span> FDT_STA_ID <span class="sc">%in%</span> WQStable<span class="sc">$</span>StationID)</span></code></pre></div>
<p>We can use this one last opportunity to test stations that didnâ€™t connect to the riverine WQS against the estuarine lines WQS as a one last hope of attributing some WQS information. We will take all stations from the WQStable that didnâ€™t snap to any WQS segments (<code>Buffer Distance</code> ==â€˜No connections within 80 mâ€™) and add those back in to our distinctSitesToDoWQS list to try to snap them to the estuarine lines spatial data.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="metadata-attribution.html#cb28-1" aria-hidden="true" tabindex="-1"></a>distinctSitesToDoWQS <span class="ot">&lt;-</span> <span class="fu">filter</span>(WQStable, <span class="st">`</span><span class="at">Buffer Distance</span><span class="st">`</span> <span class="sc">==</span><span class="st">&#39;No connections within 80 m&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-2"><a href="metadata-attribution.html#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(dplyr<span class="sc">::</span><span class="fu">select</span>(distinctSites_sf, FDT_STA_ID, Latitude, Longitude, SUBBASIN) <span class="sc">%&gt;%</span></span>
<span id="cb28-3"><a href="metadata-attribution.html#cb28-3" aria-hidden="true" tabindex="-1"></a>              <span class="fu">rename</span>(<span class="st">&#39;StationID&#39;</span><span class="ot">=</span> <span class="st">&#39;FDT_STA_ID&#39;</span>), <span class="at">by=</span><span class="st">&#39;StationID&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-4"><a href="metadata-attribution.html#cb28-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(geometry)) <span class="sc">%&gt;%</span></span>
<span id="cb28-5"><a href="metadata-attribution.html#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;Longitude&quot;</span>, <span class="st">&quot;Latitude&quot;</span>),  <span class="co"># make spatial layer using these columns</span></span>
<span id="cb28-6"><a href="metadata-attribution.html#cb28-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">remove =</span> T, <span class="co"># don&#39;t remove these lat/lon cols from df</span></span>
<span id="cb28-7"><a href="metadata-attribution.html#cb28-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">crs =</span> <span class="dv">4326</span>)</span></code></pre></div>
</div>
<div id="estuarine-lines-wqs" class="section level5" number="3.1.3.2.2">
<h5><span class="header-section-number">3.1.3.2.2</span> Estuarine Lines (WQS)</h5>
<p>If a site doesnâ€™t attach to a riverine segment, our last step is to try to attach estuary line segments before throwing an empty site to the users for the wild west of manual QA. Only send sites that could be in estuarine subbasin to this function to not waste time.
Removes any estuary lines sites from the data frame of unique sites that need WQS information.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="metadata-attribution.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&#39;snappingFunctions/snapWQS.R&#39;</span>)</span>
<span id="cb29-2"><a href="metadata-attribution.html#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="metadata-attribution.html#cb29-3" aria-hidden="true" tabindex="-1"></a>estuarineLines <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&#39;../GIS/draft_WQS_shapefiles_2022/estuarinelines_draft2022.shp&#39;</span> , <span class="at">fid_column_name =</span> <span class="st">&quot;OBJECTID&quot;</span>) <span class="co">#%&gt;%</span></span>
<span id="cb29-4"><a href="metadata-attribution.html#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#st_transform(102003) # forcing to albers from start bc such a huge layer</span></span>
<span id="cb29-5"><a href="metadata-attribution.html#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#st_transform(4326)</span></span>
<span id="cb29-6"><a href="metadata-attribution.html#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="metadata-attribution.html#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Only send sites to function that could be in estuarine environment</span></span>
<span id="cb29-8"><a href="metadata-attribution.html#cb29-8" aria-hidden="true" tabindex="-1"></a>WQStable <span class="ot">&lt;-</span> <span class="fu">snapAndOrganizeWQS</span>(<span class="fu">filter</span>(distinctSitesToDoWQS, SUBBASIN <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Potomac River&quot;</span>,</span>
<span id="cb29-9"><a href="metadata-attribution.html#cb29-9" aria-hidden="true" tabindex="-1"></a>                                                                            <span class="st">&quot;Rappahannock River&quot;</span>, </span>
<span id="cb29-10"><a href="metadata-attribution.html#cb29-10" aria-hidden="true" tabindex="-1"></a>                                                                            <span class="st">&quot;Atlantic Ocean Coastal&quot;</span>,</span>
<span id="cb29-11"><a href="metadata-attribution.html#cb29-11" aria-hidden="true" tabindex="-1"></a>                                                                            <span class="st">&quot;Chesapeake Bay Tributaries&quot;</span>,</span>
<span id="cb29-12"><a href="metadata-attribution.html#cb29-12" aria-hidden="true" tabindex="-1"></a>                                                                            <span class="st">&quot;Chesapeake Bay - Mainstem&quot;</span>,</span>
<span id="cb29-13"><a href="metadata-attribution.html#cb29-13" aria-hidden="true" tabindex="-1"></a>                                                                            <span class="st">&quot;James River - Lower&quot;</span>,  </span>
<span id="cb29-14"><a href="metadata-attribution.html#cb29-14" aria-hidden="true" tabindex="-1"></a>                                                                            <span class="st">&quot;Appomattox River&quot;</span>,</span>
<span id="cb29-15"><a href="metadata-attribution.html#cb29-15" aria-hidden="true" tabindex="-1"></a>                                                                            <span class="st">&quot;Chowan River&quot;</span>, </span>
<span id="cb29-16"><a href="metadata-attribution.html#cb29-16" aria-hidden="true" tabindex="-1"></a>                                                                            <span class="st">&quot;Atlantic Ocean - South&quot;</span> ,</span>
<span id="cb29-17"><a href="metadata-attribution.html#cb29-17" aria-hidden="true" tabindex="-1"></a>                                                                            <span class="st">&quot;Dismal Swamp/Albemarle Sound&quot;</span>)),</span>
<span id="cb29-18"><a href="metadata-attribution.html#cb29-18" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&#39;StationID&#39;</span>, estuarineLines, </span>
<span id="cb29-19"><a href="metadata-attribution.html#cb29-19" aria-hidden="true" tabindex="-1"></a>                               <span class="at">bufferDistances =</span> <span class="fu">seq</span>(<span class="dv">20</span>,<span class="dv">80</span>,<span class="at">by=</span><span class="dv">20</span>),  <span class="co"># buffering by 20m from 20 - 80 meters</span></span>
<span id="cb29-20"><a href="metadata-attribution.html#cb29-20" aria-hidden="true" tabindex="-1"></a>                               WQStable)</span>
<span id="cb29-21"><a href="metadata-attribution.html#cb29-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-22"><a href="metadata-attribution.html#cb29-22" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(estuarineLines)</span></code></pre></div>
<p>Remove stations that attached to estuarine segments from the â€˜to doâ€™ list.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="metadata-attribution.html#cb30-1" aria-hidden="true" tabindex="-1"></a>distinctSitesToDoWQS <span class="ot">&lt;-</span> <span class="fu">filter</span>(distinctSitesToDoWQS, <span class="sc">!</span> StationID <span class="sc">%in%</span> WQStable<span class="sc">$</span>StationID)</span></code></pre></div>
<p>Double check no stations were lost in these processes.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="metadata-attribution.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Make sure all stations from original distinct station list have some sort of record (blank or populated) int the WQStable.</span></span>
<span id="cb31-2"><a href="metadata-attribution.html#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="metadata-attribution.html#cb31-3" aria-hidden="true" tabindex="-1"></a>distinctSitesToDoWQS <span class="ot">&lt;-</span> <span class="fu">filter</span>(distinctSitesToDo, <span class="sc">!</span> FDT_STA_ID  <span class="sc">%in%</span> WQStableExisting<span class="sc">$</span>StationID)</span>
<span id="cb31-4"><a href="metadata-attribution.html#cb31-4" aria-hidden="true" tabindex="-1"></a>distinctSitesToDoWQS<span class="sc">$</span>FDT_STA_ID[<span class="sc">!</span>(distinctSitesToDoWQS<span class="sc">$</span>FDT_STA_ID <span class="sc">%in%</span> <span class="fu">unique</span>(WQStable<span class="sc">$</span>StationID))]</span></code></pre></div>
</div>
</div>
<div id="assign-something-to-wqs_id-so-sites-will-not-fall-through-the-cracks-when-application-filtering-occurs" class="section level4" number="3.1.3.3">
<h4><span class="header-section-number">3.1.3.3</span> Assign something to WQS_ID so sites will not fall through the cracks when application filtering occurs</h4>
<p>We donâ€™t want to give all the assessors statewide all the stations that didnâ€™t snap to something, so we need to at least partially assign a WQS_ID so the stations get into the correct subbasin on initial filter.</p>
<p>If a station snapped to nothing, we will assigning it a RL WQS_ID and subbasin it falls into by default.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="metadata-attribution.html#cb32-1" aria-hidden="true" tabindex="-1"></a>WQStableMissing <span class="ot">&lt;-</span> <span class="fu">filter</span>(WQStable, <span class="fu">is.na</span>(WQS_ID)) <span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="metadata-attribution.html#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># drop from list if actually fixed by snap to another segment</span></span>
<span id="cb32-3"><a href="metadata-attribution.html#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span> StationID <span class="sc">%in%</span> <span class="fu">filter</span>(WQStable, <span class="fu">str_extract</span>(WQS_ID, <span class="st">&quot;^.{2}&quot;</span>) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;EL&#39;</span>,<span class="st">&#39;LP&#39;</span>,<span class="st">&#39;EP&#39;</span>))<span class="sc">$</span>StationID) <span class="sc">%&gt;%</span></span>
<span id="cb32-4"><a href="metadata-attribution.html#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(dplyr<span class="sc">::</span><span class="fu">select</span>(distinctSites_sf, FDT_STA_ID, BASIN_CODE) <span class="sc">%&gt;%</span></span>
<span id="cb32-5"><a href="metadata-attribution.html#cb32-5" aria-hidden="true" tabindex="-1"></a>              <span class="fu">st_drop_geometry</span>(), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&#39;StationID&#39;</span> <span class="ot">=</span> <span class="st">&#39;FDT_STA_ID&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb32-6"><a href="metadata-attribution.html#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># some fixes for missing basin codes so they will match proper naming conventions for filtering</span></span>
<span id="cb32-7"><a href="metadata-attribution.html#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">BASIN_CODE1 =</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(BASIN_CODE) <span class="sc">~</span> <span class="fu">str_pad</span>(</span>
<span id="cb32-8"><a href="metadata-attribution.html#cb32-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">&#39;-&#39;</span>, <span class="fu">str_extract</span>(StationID, <span class="st">&quot;^.{2}&quot;</span>)), <span class="fu">str_extract</span>(StationID, <span class="st">&quot;^.{1}&quot;</span>), <span class="fu">str_extract</span>(StationID, <span class="st">&quot;^.{2}&quot;</span>)), </span>
<span id="cb32-9"><a href="metadata-attribution.html#cb32-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="dv">2</span>, <span class="at">side =</span> <span class="st">&#39;left&#39;</span>, <span class="at">pad =</span> <span class="st">&#39;0&#39;</span>),</span>
<span id="cb32-10"><a href="metadata-attribution.html#cb32-10" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">as.character</span>(BASIN_CODE)),</span>
<span id="cb32-11"><a href="metadata-attribution.html#cb32-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">BASIN_CODE2 =</span> <span class="fu">str_pad</span>(BASIN_CODE1, <span class="at">width =</span> <span class="dv">2</span>, <span class="at">side =</span> <span class="st">&#39;left&#39;</span>, <span class="at">pad =</span> <span class="st">&#39;0&#39;</span>),</span>
<span id="cb32-12"><a href="metadata-attribution.html#cb32-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">WQS_ID =</span> <span class="fu">paste0</span>(<span class="st">&#39;RL_&#39;</span>, BASIN_CODE2,<span class="st">&#39;_NA&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb32-13"><a href="metadata-attribution.html#cb32-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(BASIN_CODE, BASIN_CODE1, BASIN_CODE2))</span>
<span id="cb32-14"><a href="metadata-attribution.html#cb32-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-15"><a href="metadata-attribution.html#cb32-15" aria-hidden="true" tabindex="-1"></a>WQStable <span class="ot">&lt;-</span> <span class="fu">filter</span>(WQStable, <span class="sc">!</span><span class="fu">is.na</span>(WQS_ID)) <span class="sc">%&gt;%</span> </span>
<span id="cb32-16"><a href="metadata-attribution.html#cb32-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span> StationID <span class="sc">%in%</span> WQStableMissing<span class="sc">$</span>StationID) <span class="sc">%&gt;%</span></span>
<span id="cb32-17"><a href="metadata-attribution.html#cb32-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(WQStableMissing)</span></code></pre></div>
</div>
</div>
<div id="join-stations-to-aus" class="section level3" number="3.1.4">
<h3><span class="header-section-number">3.1.4</span> Join Stations to AUs</h3>
<p>Assessment Units (AU) are different from WQS attribution steps because these links can change cycle to cycle as new AUs are broken off from existing AUs to more appropriately represent . Thus, a single record of all AUs linked to StationIDs like the WQSlookup table is not a good solution for this use case. Instead the AU to StationID link is stored in a more temporary format (Station Table Excel file) such that regional assessment staff can easily update the AU information on the fly as they assess stations.</p>
<p>Generally, the logic holds that <strong>the provided AUs are a starting point for an upcoming assessment cycle, not necessarily the final AU for said assessment cycle.</strong> The process to link unique stations in an assessment window (<code>distinctSites_sf</code>) to AU information begins by joining all sites in an upcoming window to the Stations Table from the most recent assessment cycle. If a station does not join to a previous assessment cycle Stations Table that means that the station either has not been sample before (e.g.Â a new station for Probabilistic Monitoring or a special study) or has not been sampled in a long time such that is outside the last assessment window and has not been carried over from a previous assessment cycle for any reason. It is these sites that did not join to the last cycleâ€™s Stations Table where we will focus our efforts in the subsequent spatial joining steps.</p>
<div id="identify-which-stations-need-au-information" class="section level4" number="3.1.4.1">
<h4><span class="header-section-number">3.1.4.1</span> Identify which stations need AU information</h4>
<p>First, bring in the final Stations Table from the most recently completed IR cycle. For this example, we are sourcing the IR2022 final Stations Table (presented as a spatial object in a file geodatabase but we will strip off the spatial data first thing since it is unnecessary for this purpose). We are also going to rename the friendly publication field names to a more standardized format that the automated assessment functions were built upon (read: we are changing field names to match previous versions of the Stations Table schema since the assessment functions were built on that data schema).</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="metadata-attribution.html#cb33-1" aria-hidden="true" tabindex="-1"></a>final2022 <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&#39;C:/HardDriveBackup/GIS/Assessment/2022IR_final/2022IR_GISData/va_ir22_wqms.gdb&#39;</span>,</span>
<span id="cb33-2"><a href="metadata-attribution.html#cb33-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">layer =</span> <span class="st">&#39;va_ir22_wqms&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb33-3"><a href="metadata-attribution.html#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>() <span class="sc">%&gt;%</span> <span class="co"># only need tabular data from here out</span></span>
<span id="cb33-4"><a href="metadata-attribution.html#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># change names of ID305B columns to format required by automated methods</span></span>
<span id="cb33-5"><a href="metadata-attribution.html#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">ID305B_1 =</span> Assessment_Unit_ID_1, <span class="at">TYPE_1 =</span> Station_Type_1,</span>
<span id="cb33-6"><a href="metadata-attribution.html#cb33-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">ID305B_2 =</span> Assessment_Unit_ID_2, <span class="at">TYPE_2 =</span> Station_Type_2,</span>
<span id="cb33-7"><a href="metadata-attribution.html#cb33-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">ID305B_3 =</span> Assessment_Unit_ID_3, <span class="at">TYPE_3 =</span> Station_Type_3,</span>
<span id="cb33-8"><a href="metadata-attribution.html#cb33-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">ID305B_4 =</span> Assessment_Unit_ID_4, <span class="at">TYPE_4 =</span> Station_Type_4,</span>
<span id="cb33-9"><a href="metadata-attribution.html#cb33-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">ID305B_5 =</span> Assessment_Unit_ID_5, <span class="at">TYPE_5 =</span> Station_Type_5,</span>
<span id="cb33-10"><a href="metadata-attribution.html#cb33-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">ID305B_6 =</span> Assessment_Unit_ID_6, <span class="at">TYPE_6 =</span> Station_Type_6,</span>
<span id="cb33-11"><a href="metadata-attribution.html#cb33-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">ID305B_7 =</span> Assessment_Unit_ID_7, <span class="at">TYPE_7 =</span> Station_Type_7,</span>
<span id="cb33-12"><a href="metadata-attribution.html#cb33-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">ID305B_8 =</span> Assessment_Unit_ID_8, <span class="at">TYPE_8 =</span> Station_Type_8,</span>
<span id="cb33-13"><a href="metadata-attribution.html#cb33-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">ID305B_9 =</span> Assessment_Unit_ID_9, <span class="at">TYPE_9 =</span> Station_Type_9,</span>
<span id="cb33-14"><a href="metadata-attribution.html#cb33-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">ID305B_10 =</span> Assessment_Unit_ID_10, <span class="at">TYPE_10 =</span> Station_Type_10)</span></code></pre></div>
<p>Now we will join distinct sites to AU information to get all available data to start the assessment process. Note: Assessors may attribute stations to different VAHU6â€™s compared to strictly where the site is located spatially to communicate that said stations (usually that lie close to VAHU6 border) are used to make assessment decisions about the designated VAHU6. For this reason, we use the VAHU6 designation from the previous assessment cycle over the VAHU6 retrieved from CEDS. If the station does not have a record in the previous assessment cycle Stations Table, the VAHU6 designation stored in CEDS is used.</p>
<p>The last rows of the below chunk ensure that each station is only listed once in the resultant table. In previous assessment cycles, stations could be assessed for multiple waterbody types (e.g.Â riverine and lacustrine assessment uses). Since the assessment database was moved from MS Access to CEDS WQA, this duplication is no longer allowed and thus each station should only have one record.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="metadata-attribution.html#cb34-1" aria-hidden="true" tabindex="-1"></a>distinctSites_AUall <span class="ot">&lt;-</span> distinctSites_sf <span class="sc">%&gt;%</span> </span>
<span id="cb34-2"><a href="metadata-attribution.html#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>() <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="metadata-attribution.html#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(final2022 <span class="sc">%&gt;%</span> </span>
<span id="cb34-4"><a href="metadata-attribution.html#cb34-4" aria-hidden="true" tabindex="-1"></a>              dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(Latitude, Longitude)), <span class="co"># drop duplicate lat/lng fields to avoid join issues</span></span>
<span id="cb34-5"><a href="metadata-attribution.html#cb34-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&#39;FDT_STA_ID&#39;</span> <span class="ot">=</span> <span class="st">&#39;Station_ID&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb34-6"><a href="metadata-attribution.html#cb34-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(FDT_STA_ID <span class="sc">:</span> VAHU6.y) <span class="sc">%&gt;%</span> <span class="co"># drop the last cycle&#39;s results, not important now</span></span>
<span id="cb34-7"><a href="metadata-attribution.html#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">VAHU6 =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(VAHU6.y), <span class="fu">as.character</span>(VAHU6.x), <span class="fu">as.character</span>(VAHU6.y))) <span class="sc">%&gt;%</span> <span class="co"># use last cycle&#39;s VAHU6 designation over CEDS designation by default if available</span></span>
<span id="cb34-8"><a href="metadata-attribution.html#cb34-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(VAHU6.x, VAHU6.y)) <span class="sc">%&gt;%</span></span>
<span id="cb34-9"><a href="metadata-attribution.html#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(FDT_STA_ID) <span class="sc">%&gt;%</span></span>
<span id="cb34-10"><a href="metadata-attribution.html#cb34-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>()</span>
<span id="cb34-11"><a href="metadata-attribution.html#cb34-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-12"><a href="metadata-attribution.html#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Find any duplicates</span></span>
<span id="cb34-13"><a href="metadata-attribution.html#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(<span class="fu">filter</span>(distinctSites_AUall, n <span class="sc">&gt;</span><span class="dv">1</span>)) <span class="co"># 0 rows, cool</span></span>
<span id="cb34-14"><a href="metadata-attribution.html#cb34-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-15"><a href="metadata-attribution.html#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="co"># above n&gt; 1 used to be stations that were riverine and lacustrine makes sense, these sites are being used for riverine and lacustrine assessment</span></span>
<span id="cb34-16"><a href="metadata-attribution.html#cb34-16" aria-hidden="true" tabindex="-1"></a><span class="co"># for IR2024 this should all be cleaned up bc new WQA CEDS rules, but always good to double check</span></span></code></pre></div>
<p>Next we will organize stations by whether or not they have AU data based on the previous join. We will call the stations that need AU information <code>distinctSites_AUtoDo</code>. We only test this using the ID305B_1 column because we only need each station to be attributed to at least one AU.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="metadata-attribution.html#cb35-1" aria-hidden="true" tabindex="-1"></a>distinctSites_AUtoDo <span class="ot">&lt;-</span> <span class="fu">filter</span>(distinctSites_AUall, <span class="fu">is.na</span>(ID305B_1)) <span class="sc">%&gt;%</span></span>
<span id="cb35-2"><a href="metadata-attribution.html#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;Longitude&quot;</span>, <span class="st">&quot;Latitude&quot;</span>),  <span class="co"># make spatial layer using these columns</span></span>
<span id="cb35-3"><a href="metadata-attribution.html#cb35-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">remove =</span> F, <span class="co"># don&#39;t remove these lat/lon cols from df</span></span>
<span id="cb35-4"><a href="metadata-attribution.html#cb35-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb35-5"><a href="metadata-attribution.html#cb35-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-6"><a href="metadata-attribution.html#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="co"># These sites are all good for automated assessment  (once we join WQS info from WQSlookup table)</span></span>
<span id="cb35-7"><a href="metadata-attribution.html#cb35-7" aria-hidden="true" tabindex="-1"></a>distinctSites_AU <span class="ot">&lt;-</span> <span class="fu">filter</span>(distinctSites_AUall, <span class="sc">!</span><span class="fu">is.na</span>(ID305B_1)) </span>
<span id="cb35-8"><a href="metadata-attribution.html#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="metadata-attribution.html#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Quick QA: double check the math works out</span></span>
<span id="cb35-10"><a href="metadata-attribution.html#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(distinctSites_AU) <span class="sc">+</span> <span class="fu">nrow</span>(distinctSites_AUtoDo) <span class="sc">==</span> <span class="fu">nrow</span>(distinctSites_AUall)</span></code></pre></div>
<p>As with the WQS spatial attribution process, we will first join these sites to polygon layers and then line features to minimize any unnecessary computational load.</p>
</div>
<div id="spatially-join-au-polygons" class="section level4" number="3.1.4.2">
<h4><span class="header-section-number">3.1.4.2</span> Spatially Join AU Polygons</h4>
<p>Since it is much faster to look for spatial joins by polygons compared to snapping to lines, we will run spatial joins by estuarine polys and reservoir layers first.</p>
<div id="estuarine-polygons-au" class="section level5" number="3.1.4.2.1">
<h5><span class="header-section-number">3.1.4.2.1</span> Estuarine Polygons (AU)</h5>
<p>We will now find any sites that fall into an estuary AU polygon. This method is only applied to subbasins that intersect estuarine areas and then removes any estuarine sites from the data frame of unique sites that need AU information (<code>distinctSites_AUtoDo</code>). The chunk below sources a custom function for handling AU polygon information <a href="https://github.com/EmmaVJones/IR2024/blob/main/1.preprocessData/preprocessingModules/AU_Poly.R">available for download here</a>.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="metadata-attribution.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&#39;preprocessingModules/AU_Poly.R&#39;</span>)</span>
<span id="cb36-2"><a href="metadata-attribution.html#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="metadata-attribution.html#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Bring in estuary layer</span></span>
<span id="cb36-4"><a href="metadata-attribution.html#cb36-4" aria-hidden="true" tabindex="-1"></a>estuaryPolysAU <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&#39;../va_aus_estuarine.shp&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-5"><a href="metadata-attribution.html#cb36-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">st_transform</span>( <span class="dv">4326</span> ) <span class="sc">%&gt;%</span></span>
<span id="cb36-6"><a href="metadata-attribution.html#cb36-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">st_cast</span>(<span class="st">&quot;MULTIPOLYGON&quot;</span>) <span class="co"># special step for weird WKB error reading in geodatabase, never encountered before, fix from: https://github.com/r-spatial/sf/issues/427</span></span>
<span id="cb36-7"><a href="metadata-attribution.html#cb36-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-8"><a href="metadata-attribution.html#cb36-8" aria-hidden="true" tabindex="-1"></a>estuaryPolysAUjoin <span class="ot">&lt;-</span> <span class="fu">polygonJoinAU</span>(estuaryPolysAU, distinctSites_AUtoDo, <span class="at">estuaryTorF =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb36-9"><a href="metadata-attribution.html#cb36-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ID305B_1 =</span> ID305B) <span class="sc">%&gt;%</span></span>
<span id="cb36-10"><a href="metadata-attribution.html#cb36-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">names</span>(distinctSites_AU)) <span class="sc">%&gt;%</span></span>
<span id="cb36-11"><a href="metadata-attribution.html#cb36-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(FDT_STA_ID) <span class="sc">%&gt;%</span></span>
<span id="cb36-12"><a href="metadata-attribution.html#cb36-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb36-13"><a href="metadata-attribution.html#cb36-13" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Buffer Distance</span><span class="st">`</span> <span class="ot">=</span> <span class="st">&#39;In polygon&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-14"><a href="metadata-attribution.html#cb36-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() </span>
<span id="cb36-15"><a href="metadata-attribution.html#cb36-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-16"><a href="metadata-attribution.html#cb36-16" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(estuaryPolysAU) <span class="co"># clean up workspace</span></span></code></pre></div>
<p>Now we add the newly identified estuary stations to <code>distinctSites_AU</code>.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="metadata-attribution.html#cb37-1" aria-hidden="true" tabindex="-1"></a>distinctSites_AU <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(distinctSites_AU, estuaryPolysAUjoin <span class="sc">%&gt;%</span> <span class="fu">st_drop_geometry</span>())</span></code></pre></div>
<p>And then remove stations that fell inside estuarine polygons from our â€˜to doâ€™ list.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="metadata-attribution.html#cb38-1" aria-hidden="true" tabindex="-1"></a>distinctSites_AUtoDo <span class="ot">&lt;-</span> <span class="fu">filter</span>(distinctSites_AUtoDo, <span class="sc">!</span> FDT_STA_ID <span class="sc">%in%</span> estuaryPolysAUjoin<span class="sc">$</span>FDT_STA_ID)</span>
<span id="cb38-2"><a href="metadata-attribution.html#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="metadata-attribution.html#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(distinctSites_AU) <span class="sc">+</span> <span class="fu">nrow</span>(distinctSites_AUtoDo) <span class="sc">==</span> <span class="fu">nrow</span>(distinctSites_AUall)</span></code></pre></div>
</div>
<div id="lake-polygons-au" class="section level5" number="3.1.4.2.2">
<h5><span class="header-section-number">3.1.4.2.2</span> Lake Polygons (AU)</h5>
<p>Next we identify any sites that fall into a lake AU polygon. This method is applied to all subbasins, unlike the previous estuary step. We then remove any lake sites from the data frame of unique sites that need AU information. The chunk below sources the same custom function for handling AU polygon information as above <a href="https://github.com/EmmaVJones/IR2024/blob/main/1.preprocessData/preprocessingModules/AU_Poly.R">available for download here</a>.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="metadata-attribution.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&#39;preprocessingModules/AU_Poly.R&#39;</span>)</span>
<span id="cb39-2"><a href="metadata-attribution.html#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="metadata-attribution.html#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Bring in Lakes layer</span></span>
<span id="cb39-4"><a href="metadata-attribution.html#cb39-4" aria-hidden="true" tabindex="-1"></a>lakesPolyAU <span class="ot">&lt;-</span>  <span class="fu">st_read</span>(<span class="st">&#39;../va_aus_reservoir.shp&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-5"><a href="metadata-attribution.html#cb39-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">st_transform</span>( <span class="dv">4326</span> ) <span class="sc">%&gt;%</span></span>
<span id="cb39-6"><a href="metadata-attribution.html#cb39-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">st_cast</span>(<span class="st">&quot;MULTIPOLYGON&quot;</span>) <span class="co"># special step for weird WKB error reading in geodatabase, never encountered before, fix from: https://github.com/r-spatial/sf/issues/427</span></span>
<span id="cb39-7"><a href="metadata-attribution.html#cb39-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-8"><a href="metadata-attribution.html#cb39-8" aria-hidden="true" tabindex="-1"></a>lakesPolysAUjoin <span class="ot">&lt;-</span> <span class="fu">polygonJoinAU</span>(lakesPolyAU, distinctSites_AUtoDo, <span class="at">estuaryTorF =</span> F)<span class="sc">%&gt;%</span></span>
<span id="cb39-9"><a href="metadata-attribution.html#cb39-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ID305B_1 =</span> ID305B,</span>
<span id="cb39-10"><a href="metadata-attribution.html#cb39-10" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Buffer Distance</span><span class="st">`</span> <span class="ot">=</span> <span class="st">&#39;In polygon&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-11"><a href="metadata-attribution.html#cb39-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">names</span>(distinctSites_AU)) <span class="sc">%&gt;%</span></span>
<span id="cb39-12"><a href="metadata-attribution.html#cb39-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(FDT_STA_ID) <span class="sc">%&gt;%</span></span>
<span id="cb39-13"><a href="metadata-attribution.html#cb39-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb39-14"><a href="metadata-attribution.html#cb39-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() </span>
<span id="cb39-15"><a href="metadata-attribution.html#cb39-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-16"><a href="metadata-attribution.html#cb39-16" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(lakesPolyAU) <span class="co"># clean up workspace</span></span></code></pre></div>
<p>Now add the lake stations to <code>distinctSites_AU</code>.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="metadata-attribution.html#cb40-1" aria-hidden="true" tabindex="-1"></a>distinctSites_AU <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(distinctSites_AU, lakesPolysAUjoin <span class="sc">%&gt;%</span> <span class="fu">st_drop_geometry</span>())</span></code></pre></div>
<p>And we remove stations that fell inside lake polygons from the â€˜to doâ€™ list. This is also a good time to double check that we havenâ€™t lost any sites in the above process.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="metadata-attribution.html#cb41-1" aria-hidden="true" tabindex="-1"></a>distinctSites_AUtoDo <span class="ot">&lt;-</span> <span class="fu">filter</span>(distinctSites_AUtoDo, <span class="sc">!</span> FDT_STA_ID <span class="sc">%in%</span> lakesPolysAUjoin<span class="sc">$</span>FDT_STA_ID)</span>
<span id="cb41-2"><a href="metadata-attribution.html#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="metadata-attribution.html#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Double check all sites are still there</span></span>
<span id="cb41-4"><a href="metadata-attribution.html#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(distinctSites_AU) <span class="sc">+</span> <span class="fu">nrow</span>(distinctSites_AUtoDo) <span class="sc">==</span> <span class="fu">nrow</span>(distinctSites_AUall)</span>
<span id="cb41-5"><a href="metadata-attribution.html#cb41-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-6"><a href="metadata-attribution.html#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="metadata-attribution.html#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(lakesPolysAUjoin);<span class="fu">rm</span>(estuaryPolysAUjoin) <span class="co"># clean up workspace</span></span></code></pre></div>
</div>
</div>
<div id="spatially-join-au-lines" class="section level4" number="3.1.4.3">
<h4><span class="header-section-number">3.1.4.3</span> Spatially Join AU Lines</h4>
<p>Now on to the more computationally heavy AU line snapping methods. We can only try to attach riverine AUs since there is not a published estuarine lines AU spatial layer (like there is for WQS information). All sites that do not snap to a riverine line within a set buffer distance will be flagged with comment saying so and the regional assessors will sort out the most appropriate AU manually in the <a href="https://rconnect.deq.virginia.gov/RegionalAssessmentMetadataValidation/">Regional Metadata Validation Tool</a>.</p>
<div id="riverine-lines-au" class="section level5" number="3.1.4.3.1">
<h5><span class="header-section-number">3.1.4.3.1</span> Riverine Lines (AU)</h5>
<p>Time to run all the sites that didnâ€™t fall into an AU polygon through our <a href="https://github.com/EmmaVJones/IR2024/blob/main/1.preprocessData/snappingFunctions/snapPointToStreamNetwork.R">polyline snapping buffering script</a>. This function is slightly different from the WQS buffering function in that it is flexible enough link any chosen fields from the two input arguments. The output of the function will add a field called <code>Buffer Distance</code> to <code>distinctSites_AU</code> to indicate the distance required for snapping. This does not get transported to the data of record, but it is useful to keep for now for QA purposes. If more than one segment is found within a set buffer distance, that many rows will be attached to the <code>snapTable</code> with the identifying station name. It is up to the <a href="https://rconnect.deq.virginia.gov/RegionalAssessmentMetadataValidation/">Regional Metadata Validation Tool</a> to help the user determine which of these AUâ€™s are correct and subsequently drop all other records.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="metadata-attribution.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&#39;snappingFunctions/snapPointToStreamNetwork.R&#39;</span>)</span>
<span id="cb42-2"><a href="metadata-attribution.html#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="metadata-attribution.html#cb42-3" aria-hidden="true" tabindex="-1"></a>riverineAU <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&#39;../va_aus_riverine.shp&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-4"><a href="metadata-attribution.html#cb42-4" aria-hidden="true" tabindex="-1"></a>     <span class="fu">st_transform</span>(<span class="dv">102003</span>)</span>
<span id="cb42-5"><a href="metadata-attribution.html#cb42-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-6"><a href="metadata-attribution.html#cb42-6" aria-hidden="true" tabindex="-1"></a>snapTable <span class="ot">&lt;-</span> <span class="fu">snapAndOrganize</span>(distinctSites_AUtoDo, <span class="st">&#39;FDT_STA_ID&#39;</span>, riverineAU, </span>
<span id="cb42-7"><a href="metadata-attribution.html#cb42-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">bufferDistances =</span> <span class="fu">seq</span>(<span class="dv">20</span>,<span class="dv">80</span>,<span class="at">by=</span><span class="dv">20</span>),  <span class="co"># buffering by 20m from 20 - 80 meters</span></span>
<span id="cb42-8"><a href="metadata-attribution.html#cb42-8" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">tibble</span>(<span class="at">StationID =</span> <span class="fu">character</span>(), <span class="at">ID305B =</span> <span class="fu">character</span>(), <span class="st">`</span><span class="at">Buffer Distance</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">character</span>()),</span>
<span id="cb42-9"><a href="metadata-attribution.html#cb42-9" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;ID305B&quot;</span>)</span>
<span id="cb42-10"><a href="metadata-attribution.html#cb42-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-11"><a href="metadata-attribution.html#cb42-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-12"><a href="metadata-attribution.html#cb42-12" aria-hidden="true" tabindex="-1"></a>snapTable <span class="ot">&lt;-</span> snapTable <span class="sc">%&gt;%</span></span>
<span id="cb42-13"><a href="metadata-attribution.html#cb42-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(distinctSites_AUtoDo, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&#39;StationID&#39;</span> <span class="ot">=</span> <span class="st">&#39;FDT_STA_ID&#39;</span>)) <span class="sc">%&gt;%</span> <span class="co"># get station information</span></span>
<span id="cb42-14"><a href="metadata-attribution.html#cb42-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">&#39;FDT_STA_ID&#39;</span> <span class="ot">=</span> <span class="st">&#39;StationID&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-15"><a href="metadata-attribution.html#cb42-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ID305B_1 =</span> ID305B) <span class="sc">%&gt;%</span></span>
<span id="cb42-16"><a href="metadata-attribution.html#cb42-16" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">names</span>(distinctSites_AU), <span class="st">`</span><span class="at">Buffer Distance</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-17"><a href="metadata-attribution.html#cb42-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(FDT_STA_ID) <span class="sc">%&gt;%</span></span>
<span id="cb42-18"><a href="metadata-attribution.html#cb42-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb42-19"><a href="metadata-attribution.html#cb42-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb42-20"><a href="metadata-attribution.html#cb42-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-21"><a href="metadata-attribution.html#cb42-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-22"><a href="metadata-attribution.html#cb42-22" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(riverineAU) <span class="co"># clean up workspace</span></span></code></pre></div>
<p>Now we can add these sites to the sites with AU information.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="metadata-attribution.html#cb43-1" aria-hidden="true" tabindex="-1"></a>distinctSites_AU <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(distinctSites_AU , snapTable )</span></code></pre></div>
<p>And then remove stations that attached to riverine segments from the â€˜to doâ€™ list.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="metadata-attribution.html#cb44-1" aria-hidden="true" tabindex="-1"></a>distinctSites_AUtoDo <span class="ot">&lt;-</span> <span class="fu">filter</span>(distinctSites_AUtoDo, <span class="sc">!</span> FDT_STA_ID <span class="sc">%in%</span> snapTable<span class="sc">$</span>FDT_STA_ID)</span></code></pre></div>
<p>We donâ€™t have estuarine lines AU information, so the sites that donâ€™t connect to any AUâ€™s at the max buffer distance will have to be sorted out by the assessors.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="metadata-attribution.html#cb45-1" aria-hidden="true" tabindex="-1"></a>distinctSites_AU <span class="ot">&lt;-</span> distinctSites_AU <span class="sc">%&gt;%</span></span>
<span id="cb45-2"><a href="metadata-attribution.html#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(FDT_STA_ID) <span class="sc">%&gt;%</span></span>
<span id="cb45-3"><a href="metadata-attribution.html#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n=</span><span class="fu">n</span>())</span></code></pre></div>
<p>We then make sure all stations from original distinct station list (<code>distinctSites_AUall</code>) have some sort of record (blank or populated) in the <code>distinctSites_AU</code> dataset.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="metadata-attribution.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check everyone dealt with</span></span>
<span id="cb46-2"><a href="metadata-attribution.html#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(distinctSites_AU) <span class="sc">+</span> <span class="fu">nrow</span>(distinctSites_AUtoDo) <span class="sc">==</span> <span class="fu">nrow</span>(distinctSites_AUall)</span>
<span id="cb46-3"><a href="metadata-attribution.html#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="metadata-attribution.html#cb46-4" aria-hidden="true" tabindex="-1"></a>distinctSites_AU<span class="sc">$</span>FDT_STA_ID[<span class="sc">!</span>(distinctSites_sf<span class="sc">$</span>FDT_STA_ID <span class="sc">%in%</span> <span class="fu">unique</span>(distinctSites_AU<span class="sc">$</span>FDT_STA_ID))]</span>
<span id="cb46-5"><a href="metadata-attribution.html#cb46-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-6"><a href="metadata-attribution.html#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">nrow</span>(distinctSites_AUtoDo) <span class="sc">==</span> <span class="dv">0</span>){<span class="fu">rm</span>(distinctSites_AUtoDo)} <span class="co"># clean up workspace if QA check good</span></span></code></pre></div>
<p>One last step to make sure buffer distances save correctly for future mapping needs.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="metadata-attribution.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(distinctSites_AU<span class="sc">$</span><span class="st">`</span><span class="at">Buffer Distance</span><span class="st">`</span>)</span>
<span id="cb47-2"><a href="metadata-attribution.html#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="metadata-attribution.html#cb47-3" aria-hidden="true" tabindex="-1"></a>distinctSites_AU<span class="sc">$</span><span class="st">`</span><span class="at">Buffer Distance</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="fu">as.character</span>(distinctSites_AU<span class="sc">$</span><span class="st">`</span><span class="at">Buffer Distance</span><span class="st">`</span>)</span></code></pre></div>
<p>So, what does the end result look like?</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="metadata-attribution.html#cb48-1" aria-hidden="true" tabindex="-1"></a>distinctSites_AU[<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>,] <span class="sc">%&gt;%</span> <span class="co"># preview first 50 rows</span></span>
<span id="cb48-2"><a href="metadata-attribution.html#cb48-2" aria-hidden="true" tabindex="-1"></a>  DT<span class="sc">::</span><span class="fu">datatable</span>(<span class="at">rownames =</span> F, <span class="at">options =</span> <span class="fu">list</span>(<span class="at">dom =</span> <span class="st">&#39;lftip&#39;</span>, <span class="at">pageLength =</span> <span class="dv">5</span>, <span class="at">scrollX =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<div id="htmlwidget-45aa19841943b36d422f" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-45aa19841943b36d422f">{"x":{"filter":"none","data":[["1AABR000.78","1AACC006.13","1AACO006.10","1AACO014.57","1AACO021.28","1AAUA003.00","1AAUA003.71","1AAUA005.35","1AAUA012.15","1AAUA012.55","1AAUA014.51","1ABAR032.50","1ABAR052.96","1ABEC004.76","1ABED000.19","1ABIR000.76","1ABOL000.05","1ABRB002.15","1ABRI000.43","1ABRU001.59","1ABRU020.12","1ABRU029.80","1ABUL010.28","1ABUL025.94","1ACAA001.18","1ACAA007.34","1ACAM002.92","1ACAS000.50","1ACAX004.57","1ACAX008.61","1ACER006.00","1ACER016.46","1ACHC001.50","1ACHO003.65","1ACOA002.87","1ACOA004.24","1ACOW000.38","1ACRA000.42","1ACRA007.81","1ACRB001.52","1ACRB001.66","1ACRF001.18","1ACUB002.61","1ACUB003.74","1ACUB008.60","1ACUB011.25","1ACUB011.78","1ACWB000.56","1ADEA000.08","1ADIF000.86"],["Rt. 659 Bridge","Rt. # 608 (Brooke Rd)","Rt. # 790 (Alban Rd)","Rt. # 620 (Braddock Rd)","Rt. # 237 (Pickett Rd)","Mid embayment, off Widewater State Park","Just before Rail Road Bridge","Day Marker # 24","SMITH LAKE - 100 YDS from Spillway","SMITH LAKE - Lower Branch (STAFFORD)","Rt. # 641 (Onville Rd)","Rt. # 671","Off Rt. 704","Rt. # 734 (Snickersville Turnpike)","SMITH LAKE - Upper Branch (STAFFORD)","Rt. # 29/211 (Lee Hwy)","Rt. # 713 (Maidstone Rd)","Rt. # 7 (Leesburg Pike)","Off Little Wicomico west of Bridge Neck","Rt. # 692 (Lucasville Rd)","Rt. # 29/15 (Lee Hwy)","Rt. # 55 (upstream)","Rt. # 28  (Centreville Rd)","Rt. # 705  (Lurette Rd)","Rt. # 676  (Catharpin Rd)","Rt. # 600","Eisenhower Ave.","Upstream of rte 624","Rt. # 663  (Taylorstown Rd)","Rt. # 673  (Featherbed Ln)","Rt. # 646  (Aden Rd)","Rt. # 806  (Elk Run Rd)","Cold Harbor Creek at Rt. 693 below dam","Rt. # 1  (Jefferson Davis Hwy)","S of channel, off Boathouse Pond","BUOY 21","Cow swamp at Rt 628, Stoney Knoll Rd","Rt. # 623 (Jacksontown Rd)","Rt. 688 (Leeds Manor Rd.)","Currioman Bay near Hollis Marsh","Currioman Bay, off mouth of Currioman Cr","Rt. # 727  (Forest Mill Rd)","Rt. # 658 (Compton Rd)","Rt. # 29/211","Rt. # 661 (Old Lee Highway)","Rt. # 50  (John Mosby Hwy)","Above confluence with Sand Branch","Rt. # 638  (Blackburn Rd)","Just upstream of confluence with Cub Run","Rt. # 193  (Georgetown Pike)"],["DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ","DEQ"],[39.179078,38.384251,38.72861111,38.811303,38.861454,38.416342,38.423247,38.43811111,38.48777778,38.48830556,38.490803,39.353142,39.208417,39.03738611,38.49244444,38.83638889,38.913596,39.04666667,37.87975,38.69195833,38.78055556,38.84883333,38.80305556,38.88944444,38.83033333,38.87025,38.80447222,38.170742,39.255,39.2325,38.64138889,38.636404,38.15847222,38.52022222,37.96685,37.95466667,38.21027778,38.91854167,38.959139,38.155386,38.1537,39.09194444,38.82113333,38.83305555,38.882375,38.90833333,38.91408333,38.62055556,38.915778,38.97583333],[-78.085543,-77.383453,-77.20333333,-77.230206,-77.270246,-77.345605,-77.354609,-77.36619445,-77.40055556,-77.40713889,-77.433612,-78.192165,-78.401,-77.72278056,-77.40375,-77.45,-77.890741,-77.43277778,-76.27494444,-77.49440278,-77.67305556,-77.75883333,-77.44972222,-77.57055556,-77.59780555,-77.684,-77.10636111,-76.910611,-77.57666667,-77.59166667,-77.51222222,-77.625626,-76.78277778,-77.36161111,-76.46695,-76.45436111,-77.07611111,-77.92676111,-77.9816,-76.74935,-76.755383,-77.6825,-77.46593056,-77.46361111,-77.46994722,-77.46683333,-77.46763889,-77.27611111,-77.464194,-77.24611111],[67,65,45,45,45,65,65,65,45,45,45,67,67,64,45,64,64,64,63,64,64,64,64,64,64,64,65,63,64,64,64,64,65,65,63,63,65,64,64,null,null,64,64,64,64,64,64,65,64,64],["Ridge and Valley","Southeastern Plains","Piedmont","Piedmont","Piedmont","Southeastern Plains","Southeastern Plains","Southeastern Plains","Piedmont","Piedmont","Piedmont","Ridge and Valley","Ridge and Valley","Northern Piedmont","Piedmont","Northern Piedmont","Northern Piedmont","Northern Piedmont","Middle Atlantic Coastal Plain","Northern Piedmont","Northern Piedmont","Northern Piedmont","Northern Piedmont","Northern Piedmont","Northern Piedmont","Northern Piedmont","Southeastern Plains","Middle Atlantic Coastal Plain","Northern Piedmont","Northern Piedmont","Northern Piedmont","Northern Piedmont","Southeastern Plains","Southeastern Plains","Middle Atlantic Coastal Plain","Middle Atlantic Coastal Plain","Southeastern Plains","Northern Piedmont","Northern Piedmont",null,null,"Northern Piedmont","Northern Piedmont","Northern Piedmont","Northern Piedmont","Northern Piedmont","Northern Piedmont","Southeastern Plains","Northern Piedmont","Northern Piedmont"],["67b","65m","45e","45e","45e","65m","65m","65m","45e","45e","45e","67b","67b","64c","45e","64a","64c","64a","63b","64a","64a","64c","64a","64a","64a","64c","65n","63b","64c","64c","64a","64b","65m","65m","63b","63b","65m","64c","64c",null,null,"64c","64b","64a","64b","64a","64a","65m","64a","64c"],["Northern Shale Valleys","Rolling Coastal Plain","Northern Inner Piedmont","Northern Inner Piedmont","Northern Inner Piedmont","Rolling Coastal Plain","Rolling Coastal Plain","Rolling Coastal Plain","Northern Inner Piedmont","Northern Inner Piedmont","Northern Inner Piedmont","Northern Shale Valleys","Northern Shale Valleys","Piedmont Uplands","Northern Inner Piedmont","Triassic Lowlands","Piedmont Uplands","Triassic Lowlands","Chesapeake-Pamlico Lowlands and Tidal Marshes","Triassic Lowlands","Triassic Lowlands","Piedmont Uplands","Triassic Lowlands","Triassic Lowlands","Triassic Lowlands","Piedmont Uplands","Chesapeake Rolling Coastal Plain","Chesapeake-Pamlico Lowlands and Tidal Marshes","Piedmont Uplands","Piedmont Uplands","Triassic Lowlands","Trap Rock and Conglomerate Uplands","Rolling Coastal Plain","Rolling Coastal Plain","Chesapeake-Pamlico Lowlands and Tidal Marshes","Chesapeake-Pamlico Lowlands and Tidal Marshes","Rolling Coastal Plain","Piedmont Uplands","Piedmont Uplands",null,null,"Piedmont Uplands","Trap Rock and Conglomerate Uplands","Triassic Lowlands","Trap Rock and Conglomerate Uplands","Triassic Lowlands","Triassic Lowlands","Rolling Coastal Plain","Triassic Lowlands","Piedmont Uplands"],["VRO","NRO","NRO","NRO","NRO","NRO","NRO","NRO","NRO","NRO","NRO","VRO","VRO","NRO","NRO","NRO","NRO","NRO","PRO","NRO","NRO","NRO","NRO","NRO","NRO","NRO","NRO","PRO","NRO","NRO","NRO","NRO","PRO","NRO","PRO","PRO","PRO","NRO","NRO","PRO","PRO","NRO","NRO","NRO","NRO","NRO","NRO","NRO","NRO","NRO"],["Valley","Northern","Northern","Northern","Northern","Northern","Northern","Northern","Northern","Northern","Northern","Valley","Valley","Northern","Northern","Northern","Northern","Northern","Piedmont","Northern","Northern","Northern","Northern","Northern","Northern","Northern","Northern","Piedmont","Northern","Northern","Northern","Northern","Piedmont","Northern","Piedmont","Piedmont","Piedmont","Northern","Northern","Piedmont","Piedmont","Northern","Northern","Northern","Northern","Northern","Northern","Northern","Northern","Northern"],["Abrams Creek","Accokeek Creek","Accotink Creek","Accotink Creek","Accotink Creek","Lower Aquia Creek","Lower Aquia Creek","Lower Aquia Creek","Upper Aquia Creek","Upper Aquia Creek","Upper Aquia Creek","Back Creek-Warm Springs Hollow","Back Creek-Mine Spring Run","Beaverdam Creek","Beaverdam Run","Cub Run","Goose Creek-Crooked Run-Gap Run","Broad Run-Beaverdam Run","Little Wicomico River","Broad Run-Rocky Branch","Broad Run-Catletts Branch","Broad Run-Trapp Branch","Lower Bull Run","Upper Bull Run","Little Bull Run","Little Bull Run","Cameron Run","Potomac River-Popes Creek","Catoctin Creek","Catoctin Creek","Cedar Run-Slate Run","Cedar Run-Walnut Branch","Potomac River-Nomini Bay","Chopawamsic Creek","Coan River","Potomac River-Hull Creek","Mattox Creek","Goose Creek-Crooked Run-Gap Run","Goose Creek-Crooked Run-Gap Run","Potomac River-Nomini Bay","Potomac River-Nomini Bay","North Fork Goose Creek","Cub Run","Cub Run","Cub Run","Cub Run","Cub Run","Neabsco Creek","Cub Run","Difficult Run"],["N","T","T","T","T","T","T","T","N","N","N","N","N","N","N","N","N","N","T","N","N","N","N","N","N","N","T","T","N","N","N","N","T","T","T","T","T","N","N","T","T","N","N","N","N","N","N","T","N","N"],["PU","PL","PL","PL","PL","PL","PL","PL","PL","PL","PL","PU","PU","PL","PL","PL","PL","PL","CB","PL","PL","PL","PL","PL","PL","PL","PL","PL","PL","PL","PL","PL","PL","PL","PL","PL","PL","PL","PL","PL","PL","PL","PL","PL","PL","PL","PL","PL","PL","PL"],["Abrams Creek","Accokeek Creek","Accotink Creek","Accotink Creek","Accotink Creek","Lower Aquia Creek","Lower Aquia Creek","Lower Aquia Creek","Upper Aquia Creek","Upper Aquia Creek","Upper Aquia Creek","Warm Springs Hollow-Back Creek","Mine Spring Run-Back Creek","Beaverdam Creek","Beaverdam Run","Cub Run","Crooked Run-Goose Creek","Beaverdam Run-Broad Run","Little Wicomico River","Rocky Branch-Broad Run","Catletts Branch-Broad Run","Trapp Branch-Broad Run","Lower Bull Run","Upper Bull Run","Little Bull Run","Little Bull Run","Cameron Run","Popes Creek-Potomac River","Catoctin Creek","Catoctin Creek","Slate Run-Cedar Run","Walnut Branch-Cedar Run","Nomini Bay-Potomac River","Chopawamsic Creek","Coan River","Hull Creek-Potomac River","Mattox Creek","Crooked Run-Goose Creek","Crooked Run-Goose Creek","Nomini Bay-Potomac River","Nomini Bay-Potomac River","North Fork Goose Creek","Cub Run","Cub Run","Cub Run","Cub Run","Cub Run","Neabsco Creek","Cub Run","Difficult Run"],["0207000409","0207001102","0207001004","0207001004","0207001004","0207001102","0207001102","0207001102","0207001102","0207001102","0207001102","0207000404","0207000404","0207000806","0207001102","0207001007","0207000805","0207000809","0208010201","0207001005","0207001005","0207001005","0207001007","0207001007","0207001007","0207001007","0207001003","0207001106","0207000803","0207000803","0207001006","0207001006","0207001108","0207001101","0207001108","0207001108","0207001106","0207000805","0207000805","0207001108","0207001108","0207000806","0207001007","0207001007","0207001007","0207001007","0207001007","0207001008","0207001007","0207000810"],["Shenandoah River Basin","Potomac River Basin","Potomac River Basin","Potomac River Basin","Potomac River Basin","Potomac River Basin","Potomac River Basin","Potomac River Basin","Potomac River Basin","Potomac River Basin","Potomac River Basin","Shenandoah River Basin","Shenandoah River Basin","Potomac River Basin","Potomac River Basin","Potomac River Basin","Potomac River Basin","Potomac River Basin","Ches. Bay and Small Coastal Basin","Potomac River Basin","Potomac River Basin","Potomac River Basin","Potomac River Basin","Potomac River Basin","Potomac River Basin","Potomac River Basin","Potomac River Basin","Potomac River Basin","Potomac River Basin","Potomac River Basin","Potomac River Basin","Potomac River Basin","Potomac River Basin","Potomac River Basin","Potomac River Basin","Potomac River Basin","Potomac River Basin","Potomac River Basin","Potomac River Basin","Potomac River Basin","Potomac River Basin","Potomac River Basin","Potomac River Basin","Potomac River Basin","Potomac River Basin","Potomac River Basin","Potomac River Basin","Potomac River Basin","Potomac River Basin","Potomac River Basin"],["Potomac-Lower","Potomac-Lower","Potomac-Lower","Potomac-Lower","Potomac-Lower","Potomac-Lower","Potomac-Lower","Potomac-Lower","Potomac-Lower","Potomac-Lower","Potomac-Lower","Potomac-Lower","Potomac-Lower","Potomac-Lower","Potomac-Lower","Potomac-Lower","Potomac-Lower","Potomac-Lower","Small Coastal","Potomac-Lower","Potomac-Lower","Potomac-Lower","Potomac-Lower","Potomac-Lower","Potomac-Lower","Potomac-Lower","Potomac-Lower","Potomac-Lower","Potomac-Lower","Potomac-Lower","Potomac-Lower","Potomac-Lower","Potomac-Lower","Potomac-Lower","Potomac-Lower","Potomac-Lower","Potomac-Lower","Potomac-Lower","Potomac-Lower","Potomac-Lower","Potomac-Lower","Potomac-Lower","Potomac-Lower","Potomac-Lower","Potomac-Lower","Potomac-Lower","Potomac-Lower","Potomac-Lower","Potomac-Lower","Potomac-Lower"],["Frederick","Stafford","Fairfax","Fairfax","Fairfax City",null,null,null,"Stafford","Stafford","Stafford","Frederick","Frederick","Loudoun","Stafford","Fairfax","Fauquier","Loudoun",null,"Prince William","Prince William","Fauquier","Fairfax","Prince William","Prince William","Prince William","Alexandria","Westmoreland","Loudoun","Loudoun","Prince William","Fauquier","Westmoreland","Stafford",null,"Northumberland","King George","Fauquier","Fauquier",null,null,"Loudoun","Fairfax","Fairfax","Fairfax","Fairfax","Fairfax","Prince William","Fairfax","Fairfax"],["069","179","059","059","600",null,null,null,"179","179","179","069","069","107","179","059","061","107",null,"153","153","061","059","153","153","153","510","193","107","107","153","061","193","179",null,"133","099","061","061",null,null,"107","059","059","059","059","059","153","059","059"],["STREAM","STREAM","STREAM","STREAM","STREAM","ESTURY","ESTURY","ESTURY","RESERV","RESERV","STREAM","STREAM","STREAM","STREAM","RESERV","STREAM","STREAM","STREAM","ESTURY","STREAM","STREAM","STREAM","STREAM","STREAM","STREAM","STREAM","STREAM","SWAMP","STREAM","STREAM","STREAM","STREAM","STREAM","ESTURY","ESTURY","STREAM","STREAM","STREAM","STREAM","ESTURY","ESTURY","STREAM","STREAM","STREAM","STREAM","STREAM","STREAM","STREAM","STREAM","STREAM"],["Station sample at stream(freshwater,freeflow,surface water)","Station sample at stream(freshwater,freeflow,surface water)","Station sample at stream(freshwater,freeflow,surface water)","Station sample at stream(freshwater,freeflow,surface water)","Station sample at stream(freshwater,freeflow,surface water)","Station sample at estuary (freshwater mix with saltwater)","Station sample at estuary (freshwater mix with saltwater)","Station sample at estuary (freshwater mix with saltwater)","Station sample at reservoir, man-made body of water","Station sample at reservoir, man-made body of water","Station sample at stream(freshwater,freeflow,surface water)","Station sample at stream(freshwater,freeflow,surface water)","Station sample at stream(freshwater,freeflow,surface water)","Station sample at stream(freshwater,freeflow,surface water)","Station sample at reservoir, man-made body of water","Station sample at stream(freshwater,freeflow,surface water)","Station sample at stream(freshwater,freeflow,surface water)","Station sample at stream(freshwater,freeflow,surface water)","Station sample at estuary (freshwater mix with saltwater)","Station sample at stream(freshwater,freeflow,surface water)","Station sample at stream(freshwater,freeflow,surface water)","Station sample at stream(freshwater,freeflow,surface water)","Station sample at stream(freshwater,freeflow,surface water)","Station sample at stream(freshwater,freeflow,surface water)","Station sample at stream(freshwater,freeflow,surface water)","Station sample at stream(freshwater,freeflow,surface water)","Station sample at stream(freshwater,freeflow,surface water)","Station located in Class VII Swamp Waters","Station sample at stream(freshwater,freeflow,surface water)","Station sample at stream(freshwater,freeflow,surface water)","Station sample at stream(freshwater,freeflow,surface water)","Station sample at stream(freshwater,freeflow,surface water)","Station sample at stream(freshwater,freeflow,surface water)","Station sample at estuary (freshwater mix with saltwater)","Station sample at estuary (freshwater mix with saltwater)","Station sample at stream(freshwater,freeflow,surface water)","Station sample at stream(freshwater,freeflow,surface water)","Station sample at stream(freshwater,freeflow,surface water)","Station sample at stream(freshwater,freeflow,surface water)","Station sample at estuary (freshwater mix with saltwater)","Station sample at estuary (freshwater mix with saltwater)","Station sample at stream(freshwater,freeflow,surface water)","Station sample at stream(freshwater,freeflow,surface water)","Station sample at stream(freshwater,freeflow,surface water)","Station sample at stream(freshwater,freeflow,surface water)","Station sample at stream(freshwater,freeflow,surface water)","Station sample at stream(freshwater,freeflow,surface water)","Station sample at stream(freshwater,freeflow,surface water)","Station sample at stream(freshwater,freeflow,surface water)","Station sample at stream(freshwater,freeflow,surface water)"],["AMBNT","AMBNT","AMBNT","AMBNT","AMBNT","AMBNT","AMBNT","AMBNT","AMBNT","AMBNT","AMBNT","AMBNT","AMBNT","AMBNT","AMBNT","AMBNT","AMBNT","AMBNT","AMBNT","AMBNT","AMBNT","AMBNT","AMBNT","AMBNT","AMBNT","AMBNT","AMBNT","TRGTED","AMBNT","AMBNT","AMBNT","AMBNT","AMBNT","AMBNT","AMBNT","AMBNT","AMBNT","AMBNT","AMBNT","AMBNT","AMBNT","AMBNT","AMBNT","AMBNT","AMBNT","AMBNT","AMBNT","AMBNT","AMBNT","AMBNT"],["Monitor ambient conditions of environment","Monitor ambient conditions of environment","Monitor ambient conditions of environment","Monitor ambient conditions of environment","Monitor ambient conditions of environment","Monitor ambient conditions of environment","Monitor ambient conditions of environment","Monitor ambient conditions of environment","Monitor ambient conditions of environment","Monitor ambient conditions of environment","Monitor ambient conditions of environment","Monitor ambient conditions of environment","Monitor ambient conditions of environment","Monitor ambient conditions of environment","Monitor ambient conditions of environment","Monitor ambient conditions of environment","Monitor ambient conditions of environment","Monitor ambient conditions of environment","Monitor ambient conditions of environment","Monitor ambient conditions of environment","Monitor ambient conditions of environment","Monitor ambient conditions of environment","Monitor ambient conditions of environment","Monitor ambient conditions of environment","Monitor ambient conditions of environment","Monitor ambient conditions of environment","Monitor ambient conditions of environment","Targeted for special purpose","Monitor ambient conditions of environment","Monitor ambient conditions of environment","Monitor ambient conditions of environment","Monitor ambient conditions of environment","Monitor ambient conditions of environment","Monitor ambient conditions of environment","Monitor ambient conditions of environment","Monitor ambient conditions of environment","Monitor ambient conditions of environment","Monitor ambient conditions of environment","Monitor ambient conditions of environment","Monitor ambient conditions of environment","Monitor ambient conditions of environment","Monitor ambient conditions of environment","Monitor ambient conditions of environment","Monitor ambient conditions of environment","Monitor ambient conditions of environment","Monitor ambient conditions of environment","Monitor ambient conditions of environment","Monitor ambient conditions of environment","Monitor ambient conditions of environment","Monitor ambient conditions of environment"],["AWTSHD","AWTSHD","TMDL","ATRND","SSTUDY","SSTUDY","ATRND","SSTUDY","AWTSHD","AWTSHD","ATRND","SSTUDY","APROB","ATRND","AWTSHD","TMDL","AWTSHD","ATRND","APROB","ATRND","AWTSHD","AWTSHD","AWTSHD","ATRND","AWTSHD","BIOMON","ATRND","SSTUDY","ATRND","AWTSHD","ATRND","ATRND","TMDL","AWTSHD","APROB","SSTUDY","AWTSHD","AWTSHD","BIOMON","APROB","APROB","AWTSHD","ATRND","SSTUDY","AWTSHD","SSTUDY","BIOMON","SSTUDY","SSTUDY","ATRND"],["Ambient Watershed Station","Ambient Watershed Station","Total Maximum Daily Load Station","Ambient Trend Station","Special Study Station","Special Study Station","Ambient Trend Station","Special Study Station","Ambient Watershed Station","Ambient Watershed Station","Ambient Trend Station","Special Study Station","Ambient Probabilistic Station","Ambient Trend Station","Ambient Watershed Station","Total Maximum Daily Load Station","Ambient Watershed Station","Ambient Trend Station","Ambient Probabilistic Station","Ambient Trend Station","Ambient Watershed Station","Ambient Watershed Station","Ambient Watershed Station","Ambient Trend Station","Ambient Watershed Station","Biological Monitoring site","Ambient Trend Station","Special Study Station","Ambient Trend Station","Ambient Watershed Station","Ambient Trend Station","Ambient Trend Station","Total Maximum Daily Load Station","Ambient Watershed Station","Ambient Probabilistic Station","Special Study Station","Ambient Watershed Station","Ambient Watershed Station","Biological Monitoring site","Ambient Probabilistic Station","Ambient Probabilistic Station","Ambient Watershed Station","Ambient Trend Station","Special Study Station","Ambient Watershed Station","Special Study Station","Biological Monitoring site","Special Study Station","Special Study Station","Ambient Trend Station"],[null,null,null,"GAGE",null,null,null,null,null,null,"GAGE",null,null,"GAGE",null,null,null,"GAGE",null,null,null,null,null,null,null,null,"GAGE",null,"GAGE",null,"GAGE","GAGE",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"GAGE"],[null,null,null,"Station with stream gage",null,null,null,null,null,null,"Station with stream gage",null,null,"Station with stream gage",null,null,null,"Station with stream gage",null,null,null,null,null,null,null,null,"Station with stream gage",null,"Station with stream gage",null,"Station with stream gage","Station with stream gage",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"Station with stream gage"],["BIO",null,null,null,null,null,null,null,null,null,null,null,"BIO",null,null,null,null,null,null,null,null,null,"BIO",null,null,null,null,null,"BIO",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["Biological Monitoring Site",null,null,null,null,null,null,null,null,null,null,null,"Biological Monitoring Site",null,null,null,null,null,null,null,null,null,"Biological Monitoring Site",null,null,null,null,null,"Biological Monitoring Site",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["11","01A","07","07","07",null,"04",null,"04B","04B","04B","11",null,"09","04B","07A","9","08",null,"07a","07C",null,"07A","07A","07A",null,"07",null,"10","10","07A","07A",null,"05",null,"01",null,"09",null,null,null,"09",null,"07A",null,"07A",null,"07",null,"08"],["ABRAMS CREEK","ACCOKEEK CREEK","ACCOTINK CREEK","ACCOTINK CREEK","Accotink Creek",null,"AQUIA CREEK","Aquia Creek","AQUIA CREEK","AQUIA CREEK","AQUIA CREEK","BACK CREEK",null,"BEAVERDAM CREEK","BEAVERDAM RUN","BIG ROCKY RUN","Bolling Branch","BROAD RUN","Bridge Creek","Broad Run","BROAD RUN","Broad Run","BULL RUN","BULL RUN","CATHARPIN CREEK","Catharpin Creek","Cameron Run",null,"CATOCTIN CREEK","CATOCTIN CREEK","CEDAR RUN","CEDAR RUN","Cold Habor Creek","CHOPAWAMSIC CREEK",null,"COAN RIVER","Cow Swamp","CROOKED RUN",null,null,null,"Crooked Run (tributary to NOG)","Cub Run","CUB RUN","Cub Run","CUB RUN","Cub Run","COW BRANCH",null,"DIFFICULT RUN"],["02070004","02070011","02070010","02070010","02070010",null,"02070011","02070011","02070011","02070011","02070011","02070004",null,"02070008","02070011","02070010","02070008","02070008","02070011","02070010","02070010","02070010","02070010","02070010","02070010","02070010","02070010",null,"02070008","02070008","02070010","02070010","02070011","02070011",null,"02070011","02070011","02070008",null,null,null,"02070008","02070010","02070010","02070010","02070010","02070010","02070010",null,"02070008"],["Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Chesapeake Bay/Atlantic Ocean and Small Coastal","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River"],["1A","1A","1A","1A","1A","1A","1A","1A","1A","1A","1A","1A","1A","1A","1A","1A","1A","1A","7A","1A","1A","1A","1A","1A","1A","1A","1A","1A","1A","1A","1A","1A","1A","1A","1A","1A","1A","1A","1A","1A","1A","1A","1A","1A","1A","1A","1A","1A","1A","1A"],["Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Chesapeake Bay Tributaries","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River","Potomac River"],["VAV-B09R_ABR01A00","VAN-A29R_ACC01A00","VAN-A15R_ACO01A00","VAN-A15R_ACO02A00","VAN-A15R_ACO03A02","VAN-A28E_AUA01B20","VAN-A28E_AUA01C00","VAN-A28E_AUA01D06","VAN-A27L_AUA01A02","VAN-A27L_AUA01A02","VAN-A27R_AUA01A00","VAV-B07R_BAR01A00","VAV-B05R_BAR03A10","VAN-A07R_BEC01A00","VAN-A27L_AUA01A02","VAN-A22R_BIR01A02","VAN-A04R_BOL01A04","VAN-A09R_BRB01A00","VAP-A34E_BRI03A22","VAN-A19R_BRU01A04","VAN-A19R_BRU07A02","VAN-A19R_BRU08B10","VAN-A23R_BUL02A02","VAN-A21R_BUL02A00","VAN-A21R_CAA01A02","VAN-A21R_CAA02A08","VAN-A13R_CAM01A04","VAP-A31R_CAS01A00","VAN-A02R_CAX01A00","VAN-A02R_CAX02A08","VAN-A18R_CER01A02","VAN-A17R_CER02A02","VAP-A32R_CHC01A14","VAN-A26R_CHO01A02","VAP-A34E_COA02B20","VAP-A34E_COA01A02","VAP-A31R_MAO01A98","VAN-A04R_CRA01A04","VAN-A04R_CRA03A20","VAP-A32E_CRB03A14","VAP-A32E_CRB02A00","VAN-A06R_CRF01A02","VAN-A22R_CUB01A00","VAN-A22R_CUB01A00","VAN-A22R_CUB02A02","VAN-A22R_CUB02A02","VAN-A22R_CUB02A02","VAN-A25R_CWB01A12","VAN-A22R_DEA01A20","VAN-A11R_DIF01A00"],[null,null,null,"VAN-A15R_ACO03A02","VAN-A15R_ACO04A02",null,null,null,"VAN-A27L_BED01A02","VAN-A27L_BED01A02",null,null,null,null,"VAN-A27L_BED01A02",null,null,"VAN-A09R_BRB02A06",null,null,null,null,null,null,null,null,null,null,null,null,"VAN-A18R_CER01B06","VAN-A17R_CER02B20",null,null,null,"VAP-A34E_COA01A98",null,null,null,null,"VAP-A32E_CRB03A14",null,null,null,null,null,null,null,null,null],[null,null,null,"VAN-A15R_ACO04A02",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"VAP-A34E_COA01B16",null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"VAP-A34E_COA02A02",null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"VAP-A34E_COA02B20",null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["VAV-B09R_ABR01A00","VAN-A29R_ACC01A00","VAN-A15R_ACO01A00","VAN-A15R_ACO02A00, VAN-A15R_ACO03A02, VAN-A15R_ACO04A02","VAN-A15R_ACO03A02, VAN-A15R_ACO04A02","VAN-A28E_AUA01B20","VAN-A28E_AUA01C00","VAN-A28E_AUA01D06","VAN-A27L_AUA01A02, VAN-A27L_BED01A02","VAN-A27L_AUA01A02, VAN-A27L_BED01A02","VAN-A27R_AUA01A00","VAV-B07R_BAR01A00","VAV-B05R_BAR03A10","VAN-A07R_BEC01A00","VAN-A27L_AUA01A02, VAN-A27L_BED01A02","VAN-A22R_BIR01A02","VAN-A04R_BOL01A04","VAN-A09R_BRB01A00, VAN-A09R_BRB02A06","VAP-A34E_BRI03A22","VAN-A19R_BRU01A04","VAN-A19R_BRU07A02","VAN-A19R_BRU08B10","VAN-A23R_BUL02A02","VAN-A21R_BUL02A00","VAN-A21R_CAA01A02","VAN-A21R_CAA02A08","VAN-A13R_CAM01A04","VAP-A31R_CAS01A00","VAN-A02R_CAX01A00","VAN-A02R_CAX02A08","VAN-A18R_CER01A02, VAN-A18R_CER01B06","VAN-A17R_CER02A02, VAN-A17R_CER02B20","VAP-A32R_CHC01A14","VAN-A26R_CHO01A02","VAP-A34E_COA02B20","VAP-A34E_COA01A02, VAP-A34E_COA01A98, VAP-A34E_COA01B16, VAP-A34E_COA02A02, VAP-A34E_COA02B20","VAP-A31R_MAO01A98","VAN-A04R_CRA01A04","VAN-A04R_CRA03A20","VAP-A32E_CRB03A14","VAP-A32E_CRB02A00, VAP-A32E_CRB03A14","VAN-A06R_CRF01A02","VAN-A22R_CUB01A00","VAN-A22R_CUB01A00","VAN-A22R_CUB02A02","VAN-A22R_CUB02A02","VAN-A22R_CUB02A02","VAN-A25R_CWB01A12","VAN-A22R_DEA01A20","VAN-A11R_DIF01A00"],["Valley","Northern","Northern","Northern","Northern","Northern","Northern","Northern","Northern","Northern","Northern","Valley","Valley","Northern","Northern","Northern","Northern","Northern","Piedmont","Northern","Northern","Northern","Northern","Northern","Northern","Northern","Northern","Piedmont","Northern","Northern","Northern","Northern","Piedmont","Northern","Piedmont","Piedmont","Piedmont","Northern","Northern","Piedmont","Piedmont","Northern","Northern","Northern","Northern","Northern","Northern","Northern","Northern","Northern"],["RIVER","RIVER","RIVER","RIVER","RIVER","ESTUARY","ESTUARY","ESTUARY","RESERVOIR","RESERVOIR","RIVER","RIVER","RIVER","RIVER","RESERVOIR","RIVER","RIVER","RIVER","ESTUARY","RIVER","RIVER","RIVER","RIVER","RIVER","RIVER","RIVER","RIVER","RIVER","RIVER","RIVER","RIVER","RIVER","RIVER","RIVER","ESTUARY","ESTUARY","RIVER","RIVER","RIVER","ESTUARY","ESTUARY","RIVER","RIVER","RIVER","RIVER","RIVER","RIVER","RIVER","RIVER","RIVER"],[null,null,null,null,null,"Transition Zone","Transition Zone","Transition Zone",null,null,null,null,null,null,null,null,null,null,"Saltwater",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"Saltwater","Saltwater",null,null,null,"Saltwater","Saltwater",null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,"Y","N",null,null,null,null,"N",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["A","A","A","A","A","C","A","A","L","L","TR","A","A","TR","L","A","A","A","C2","TR","A","A","A","A","A","A","TR","SS","CB","B","TR","A","A","A","C2","C","A","A","B","C2","C2","A","A","A","A","A","A","A","A","A"],["B",null,"SS","B","SS","C2","C",null,null,null,null,null,"B",null,null,"B","IM","C","CB-B",null,null,null,"SS","B","B","B",null,null,"TR",null,null,"B",null,"SS","CB-B",null,null,null,null,"CB-B","CB-B",null,"B","B","B","B","B",null,"TM","C"],[null,null,"TM","SS","TM",null,"TR",null,null,null,null,null,"FPM",null,null,"TM",null,"TR",null,null,null,null,null,"SS","TM","TM",null,null,null,null,null,"TR",null,null,null,null,null,null,null,null,null,null,"C","TM","TM","SS","SS",null,null,"SS"],[null,null,null,"TM",null,null,null,null,null,null,null,null,"PA",null,null,null,null,null,null,null,null,null,null,"TR",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"IM",null,null,"TM","TM",null,null,"TR"],[null,null,null,"TR",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"TM",null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"TR",null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["A, B","A","A, SS, TM","A, B, SS, TM, TR","A, SS, TM","C, C2","A, C, TR","A","L","L","TR","A","A, B, FPM, PA","TR","L","A, B, TM","A, IM","A, C, TR","C2, CB-B","TR","A","A","A, SS","A, B, SS, TR","A, B, TM","A, B, TM","TR","SS","CB, TR","B","TR","A, B, TR","A","A, SS","C2, CB-B","C","A","A","B","C2, CB-B","C2, CB-B","A","A, B, C, IM, TM, TR","A, B, TM","A, B, TM","A, B, SS, TM","A, B, SS, TM","A","A, TM","A, C, SS, TR"],["PU17","PL58","PL30","PL30","PL30","PL57","PL57","PL57","PL56","PL56","PL56","PU15","PU10","PL11","PL55","PL45","PL07","PL19","CB01","PL34","PL32","PL31","PL46","PL42","PL43","PL43","PL26","PL67","PL03","PL03","PL40","PL38","PL69","PL53","PL72","PL72","PL66","PL07","PL07","PL69","PL69","PL12","PL45","PL45","PL45","PL45","PL45","PL49","PL45","PL22"],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>FDT_STA_ID<\/th>\n      <th>STA_DESC<\/th>\n      <th>Data_Source<\/th>\n      <th>Latitude<\/th>\n      <th>Longitude<\/th>\n      <th>US_L3CODE<\/th>\n      <th>US_L3NAME<\/th>\n      <th>US_L4CODE<\/th>\n      <th>US_L4NAME<\/th>\n      <th>ASSESS_REG<\/th>\n      <th>OFFICE_NM<\/th>\n      <th>VaName<\/th>\n      <th>Tidal<\/th>\n      <th>VAHUSB<\/th>\n      <th>FedName<\/th>\n      <th>HUC10<\/th>\n      <th>Basin<\/th>\n      <th>Basin_Code<\/th>\n      <th>CountyCityName<\/th>\n      <th>FIPS<\/th>\n      <th>Sta_Lv1_Code<\/th>\n      <th>Lv1_Description<\/th>\n      <th>Sta_Lv2_Code<\/th>\n      <th>Lv2_Description<\/th>\n      <th>Sta_Lv3_Code<\/th>\n      <th>Lv3_Description<\/th>\n      <th>Sta_Lv4_Code<\/th>\n      <th>Lv4_Description<\/th>\n      <th>Sta_Lv5_Code<\/th>\n      <th>Lv5_Description<\/th>\n      <th>Sta_Stream_Section<\/th>\n      <th>Sta_Stream_Name<\/th>\n      <th>Sta_Huc_Code<\/th>\n      <th>BASIN_NAME<\/th>\n      <th>BASIN_CODE<\/th>\n      <th>SUBBASIN<\/th>\n      <th>ID305B_1<\/th>\n      <th>ID305B_2<\/th>\n      <th>ID305B_3<\/th>\n      <th>ID305B_4<\/th>\n      <th>ID305B_5<\/th>\n      <th>ID305B_6<\/th>\n      <th>ID305B_7<\/th>\n      <th>ID305B_8<\/th>\n      <th>ID305B_9<\/th>\n      <th>ID305B_10<\/th>\n      <th>Assessment_Unit_List<\/th>\n      <th>Region<\/th>\n      <th>Water_Type<\/th>\n      <th>Salinity<\/th>\n      <th>Lacustrine<\/th>\n      <th>TYPE_1<\/th>\n      <th>TYPE_2<\/th>\n      <th>TYPE_3<\/th>\n      <th>TYPE_4<\/th>\n      <th>TYPE_5<\/th>\n      <th>TYPE_6<\/th>\n      <th>TYPE_7<\/th>\n      <th>TYPE_8<\/th>\n      <th>TYPE_9<\/th>\n      <th>TYPE_10<\/th>\n      <th>Station_Type_List<\/th>\n      <th>VAHU6<\/th>\n      <th>n<\/th>\n      <th>Buffer Distance<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"lftip","pageLength":5,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[3,4,5,63]}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="where-does-this-information-go" class="section level3" number="3.1.5">
<h3><span class="header-section-number">3.1.5</span> Where does this information go?</h3>
<p>The above analyses help populate the <a href="https://rconnect.deq.virginia.gov/RegionalAssessmentMetadataValidation/">Regional Metadata Validation Tool</a>. After assessors manually review each station that requires WQS/AU information, this data is consolidated and stored on the R server as a pinned dataset (see <a href=""></a> for details on that process). That dataset feeds subsequent tools including the <a href="https://rconnect.deq.virginia.gov/IR2022riverineAssessmentApplication/">Riverine Assessment App</a>, <a href="https://rconnect.deq.virginia.gov/IR2022LakesAssessmentApp/">Lakes Assessment App</a>, and <a href="https://rconnect.deq.virginia.gov/IR2022BioassessmentDashboard/">Bioassessment Dashboard</a> in addition to querying tools including the <a href="https://rconnect.deq.virginia.gov/CEDSWQMDataQueryTool/">CEDS WQM Data Query Tool</a> and <a href="https://rconnect.deq.virginia.gov/CEDSBenthicDataQueryTool/">CEDS Benthic Data Query Tool</a>. The data is provided via the internal GIS services in the WQM Stations (All stations with full attributes) layer hosted on the <a href="https://gis.deq.virginia.gov/arcgis/rest/services/staff/DEQInternalDataViewer/MapServer/104">GIS REST service</a> and <a href="https://gis.deq.virginia.gov/GISStaffApplication/">GIS Staff Application</a>. In addition to the published tools that source this data, the dataset is included in countless data analysis projects and products. The entire dataset may be pulled from the R Connect service using the following script. Please see the <a href="https://rconnect.deq.virginia.gov/MethodsEncyclopedia/connectToConnectPins.html">DEQ R Methods Encyclopedia</a> for information on how to retrieve pinned data from the server.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="metadata-attribution.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pin_get</span>(<span class="st">&#39;ejones/WQSlookup&#39;</span>, <span class="at">board =</span> <span class="st">&#39;rsconnect&#39;</span>) <span class="co"># raw lookup table</span></span>
<span id="cb49-2"><a href="metadata-attribution.html#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pin_get</span>(<span class="st">&quot;ejones/WQSlookup-withStandards&quot;</span>, <span class="at">board =</span> <span class="st">&quot;rsconnect&quot;</span>) <span class="co"># lookup table with WQS information joined </span></span></code></pre></div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="automated-assessment-methods.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="organize-metadata.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": null
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["series.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
